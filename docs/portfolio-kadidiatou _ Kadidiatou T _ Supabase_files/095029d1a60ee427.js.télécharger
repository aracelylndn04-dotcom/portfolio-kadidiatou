;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="856aee0e-5b80-79cb-d668-3594785590d7")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,547723,e=>{"use strict";var t=e.i(478902),a=e.i(389959),s=e.i(843778);let r=(0,a.forwardRef)((e,a)=>(0,t.jsx)("nav",{ref:a,dir:"ltr",...e,className:(0,s.cn)("border-b",e.className),children:(0,t.jsx)("ul",{role:"menu",className:"flex gap-5",children:e.children})})),i=(0,a.forwardRef)(({children:e,className:a,active:r,...i},l)=>(0,t.jsx)("li",{ref:l,"aria-selected":r?"true":"false","data-state":r?"active":"inactive",className:(0,s.cn)("inline-flex items-center justify-center whitespace-nowrap text-sm ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:text-foreground text-foreground-lighter hover:text-foreground data-[state=active]:border-foreground border-b-2 border-transparent *:py-1.5",a),...i,children:e}));e.s(["NavMenu",0,r,"NavMenuItem",0,i])},744061,418638,e=>{"use strict";var t=e.i(478902),a=e.i(938933),s=e.i(843778);function r({children:e,className:a,tag:s="div",style:r}){let i=`${s}`;return(0,t.jsx)(i,{style:r,children:e})}r.Title=function({className:e,level:a=1,children:s,style:r}){let i=`h${a}`;return(0,t.jsx)(i,{style:r,children:s})},r.Text=function({className:e,children:a,style:s,type:r,disabled:i,mark:l,code:n,keyboard:c,underline:o,strikethrough:d,strong:u,small:m}){return n?(0,t.jsx)("code",{style:s,children:a}):l?(0,t.jsx)("mark",{style:s,children:a}):c?(0,t.jsx)("kbd",{style:s,children:a}):u?(0,t.jsx)("strong",{style:s,children:a}):(0,t.jsx)("span",{style:s,children:a})},r.Link=function({children:e,target:a="_blank",href:s,className:r,onClick:i,style:l}){return(0,t.jsx)("a",{onClick:i,href:s,target:a,rel:"noopener noreferrer",style:l,children:e})},e.s(["default",0,r],418638);var i=e.i(389959);let l=(0,i.createContext)({type:"text"}),n=e=>{let{type:a}=e;return(0,t.jsx)(l.Provider,{value:{type:a},children:e.children})},c=()=>{let e=(0,i.useContext)(l);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function o({children:e,className:a,ulClassName:s,style:r,type:i="text"}){return(0,t.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:a,style:r,children:(0,t.jsx)(n,{type:i,children:(0,t.jsx)("ul",{className:s,children:e})})})}o.Item=function({children:e,icon:r,active:i,rounded:l,onClick:n,doNotCloseOverlay:o=!1,showActiveBar:d=!1,style:u}){let m=(0,a.default)("menu"),{type:h}=c(),p=[m.item.base];p.push(m.item.variants[h].base),i?p.push(m.item.variants[h].active):p.push(m.item.variants[h].normal);let f=[m.item.content.base];i?f.push(m.item.content.active):f.push(m.item.content.normal);let g=[m.item.icon.base];return i?g.push(m.item.icon.active):g.push(m.item.icon.normal),(0,t.jsxs)("li",{role:"menuitem",className:(0,s.cn)("outline-none",p),style:u,onClick:n,"aria-current":i?"page":void 0,children:[r&&(0,t.jsx)("div",{className:`${g.join(" ")} min-w-fit`,children:r}),(0,t.jsx)("span",{className:f.join(" "),children:e})]})},o.Group=function({children:e,icon:s,title:r}){let i=(0,a.default)("menu"),{type:l}=c();return(0,t.jsxs)("div",{className:[i.group.base,i.group.variants[l]].join(" "),children:[s&&(0,t.jsx)("span",{className:i.group.icon,children:s}),(0,t.jsx)("span",{className:i.group.content,children:r}),e]})},o.Misc=function({children:e}){return(0,t.jsx)("div",{children:(0,t.jsx)(r.Text,{children:(0,t.jsx)("span",{children:e})})})},e.s(["default",0,o],744061)},862326,e=>{"use strict";var t=e.i(744061);e.s(["Menu",()=>t.default])},3259,100387,e=>{"use strict";var t=e.i(478902),a=e.i(153545),s=e.i(933505);e.s(["ChevronRightIcon",()=>s.default],100387);var s=s,r=e.i(389959),i=e.i(843778);let l=r.forwardRef(({...e},a)=>(0,t.jsx)("nav",{ref:a,"aria-label":"breadcrumb",...e}));l.displayName="Breadcrumb";let n=r.forwardRef(({className:e,...a},s)=>(0,t.jsx)("ol",{ref:s,className:(0,i.cn)("flex flex-wrap items-center gap-0.5 break-words text-sm text-muted-foreground sm:gap-1.5",e),...a}));n.displayName="BreadcrumbList";let c=r.forwardRef(({className:e,...a},s)=>(0,t.jsx)("li",{ref:s,className:(0,i.cn)("inline-flex text-foreground-lighter items-center gap-1.5 leading-5",e),...a}));c.displayName="BreadcrumbItem";let o=r.forwardRef(({asChild:e,className:s,...r},l)=>{let n=e?a.Slot:"a";return(0,t.jsx)(n,{ref:l,className:(0,i.cn)("transition-colors underline lg:no-underline hover:text-foreground",s),...r})});o.displayName="BreadcrumbLink";let d=r.forwardRef(({className:e,...a},s)=>(0,t.jsx)("span",{ref:s,role:"link","aria-disabled":"true","aria-current":"page",className:(0,i.cn)("no-underline text-foreground",e),...a}));d.displayName="BreadcrumbPage";let u=({children:e,className:a,...r})=>(0,t.jsx)("li",{role:"presentation","aria-hidden":"true",className:(0,i.cn)("[&>svg]:size-3.5 text-foreground-muted",a),...r,children:e??(0,t.jsx)(s.default,{})});u.displayName="BreadcrumbSeparator";let m=({className:e,...a})=>(0,t.jsxs)("span",{className:(0,i.cn)("flex h-4 w-4 items-center justify-center",e),...a,children:[(0,t.jsx)("svg",{role:"presentation","aria-hidden":"true",width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{d:"M3.625 7.5C3.625 8.12132 3.12132 8.625 2.5 8.625C1.87868 8.625 1.375 8.12132 1.375 7.5C1.375 6.87868 1.87868 6.375 2.5 6.375C3.12132 6.375 3.625 6.87868 3.625 7.5ZM8.625 7.5C8.625 8.12132 8.12132 8.625 7.5 8.625C6.87868 8.625 6.375 8.12132 6.375 7.5C6.375 6.87868 6.87868 6.375 7.5 6.375C8.12132 6.375 8.625 6.87868 8.625 7.5ZM12.5 8.625C13.1213 8.625 13.625 8.12132 13.625 7.5C13.625 6.87868 13.1213 6.375 12.5 6.375C11.8787 6.375 11.375 6.87868 11.375 7.5C11.375 8.12132 11.8787 8.625 12.5 8.625Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}),(0,t.jsx)("span",{className:"sr-only",children:"More"})]});m.displayName="BreadcrumbEllipsis",e.s(["Breadcrumb",()=>l,"BreadcrumbEllipsis",()=>m,"BreadcrumbItem",()=>c,"BreadcrumbLink",()=>o,"BreadcrumbList",()=>n,"BreadcrumbPage",()=>d,"BreadcrumbSeparator",()=>u],3259)},127739,e=>{"use strict";var t=e.i(478902),a=e.i(709520),s=e.i(389959),r=e.i(843778);let i=(0,a.cva)(["mx-auto w-full @container px-6 xl:px-10"],{variants:{size:{small:"max-w-[768px]",default:"max-w-[1200px]",large:"max-w-[1600px]",full:"max-w-none"}},defaultVariants:{size:"default"}}),l=(0,s.forwardRef)(({className:e,size:a,...s},l)=>(0,t.jsx)("div",{ref:l,...s,className:(0,r.cn)(i({size:a}),e)}));l.displayName="PageContainer",e.s(["PageContainer",0,l])},456050,e=>{"use strict";var t=e.i(478902),a=e.i(709520),s=e.i(389959),r=e.i(843778),i=e.i(3259),l=e.i(127739);let n=(0,a.cva)(["flex flex-col gap-4 w-full"],{variants:{size:{default:"pt-12",small:"pt-12",large:"pt-12",full:"pt-6"}},defaultVariants:{size:"default"}}),c=(0,s.createContext)({size:"default"}),o=()=>(0,s.useContext)(c),d=({className:e,size:a,children:s,...i})=>{let l=a??"default";return(0,t.jsx)(c.Provider,{value:{size:l},children:(0,t.jsx)("div",{"data-slot":"page-header","data-size":l,className:(0,r.cn)(n({size:l}),e),...i,children:s})})},u=({className:e,children:a,...s})=>{let{size:n}=o();return(0,t.jsx)(l.PageContainer,{size:n,children:(0,t.jsx)(i.Breadcrumb,{"data-slot":"page-header-breadcrumb",className:(0,r.cn)("flex items-center gap-4 [&_li]:text-xs",e),...s,children:a})})};u.displayName="PageHeaderBreadcrumb";let m=({className:e,...a})=>(0,t.jsx)("div",{"data-slot":"page-header-icon",className:(0,r.cn)("text-foreground-light",e),...a});m.displayName="PageHeaderIcon";let h=({className:e,children:a,...s})=>(0,t.jsx)("div",{"data-slot":"page-header-summary",className:(0,r.cn)("flex flex-col gap-1",e),...s,children:a});h.displayName="PageHeaderSummary";let p=({className:e,children:a,...s})=>(0,t.jsx)("h1",{"data-slot":"page-header-title",className:(0,r.cn)("heading-title",e),...s,children:a}),f=({className:e,children:a,...s})=>(0,t.jsx)("div",{"data-slot":"page-header-description",className:(0,r.cn)("heading-subSection text-foreground-light",e),...s,children:a}),g=({className:e,children:a,...s})=>{let{size:i}=o();return(0,t.jsx)(l.PageContainer,{size:i,children:(0,t.jsx)("div",{"data-slot":"page-header-meta",className:(0,r.cn)("flex flex-col @xl:flex-row @xl:justify-between @xl:items-center gap-4",'[&>[data-slot="page-header-icon"]]:shrink-0','[&>[data-slot="page-header-summary"]]:flex-1',e),...s,children:a})})};g.displayName="PageHeaderMeta";let j=({className:e,...a})=>(0,t.jsx)("div",{"data-slot":"page-header-actions",className:(0,r.cn)("flex items-center gap-2 shrink-0",e),...a});j.displayName="PageHeaderAside";let x=({className:e,...a})=>{let{size:s}=o();return(0,t.jsx)(l.PageContainer,{size:s,className:(0,r.cn)("full"===s&&"border-b"),children:(0,t.jsx)("div",{"data-slot":"page-header-footer",className:(0,r.cn)("w-full [&>nav]:border-b-0","full"!==s&&"border-b",e),...a})})};x.displayName="PageHeaderNavigationTabs",e.s(["PageHeader",()=>d,"PageHeaderAside",()=>j,"PageHeaderBreadcrumb",()=>u,"PageHeaderDescription",()=>f,"PageHeaderIcon",()=>m,"PageHeaderMeta",()=>g,"PageHeaderNavigationTabs",()=>x,"PageHeaderSummary",()=>h,"PageHeaderTitle",()=>p])},12214,e=>{"use strict";var t=e.i(615515);let a=e=>Object.fromEntries(e.map(e=>e.split("=")));function s(e,t){if("wasm_fdw_handler"===e.handlerName){let s=a(t?.server_options??[]);return e.server.options.find(e=>"fdw_package_name"===e.name)?.defaultValue===s.fdw_package_name}return e.handlerName===t?.handler}function r(e){return t.WRAPPERS.find(t=>s(t,e))}e.s(["convertKVStringArrayToJson",0,a,"formatWrapperTables",0,(e,a)=>(e?.tables??[]).map(s=>{let r=0,i=Object.fromEntries(s.options.map(e=>e.split("=")));switch(e.handler){case t.WRAPPER_HANDLERS.STRIPE:r=a?.tables.findIndex(e=>e.options.find(e=>"object"===e.name)?.defaultValue===i.object)??0;break;case t.WRAPPER_HANDLERS.FIREBASE:r="auth/users"===i.object?a?.tables.findIndex(e=>e.options.find(e=>"auth/users"===e.defaultValue))??0:a?.tables.findIndex(e=>"Firestore Collection"===e.label)??0;case t.WRAPPER_HANDLERS.S3:case t.WRAPPER_HANDLERS.AIRTABLE:case t.WRAPPER_HANDLERS.LOGFLARE:case t.WRAPPER_HANDLERS.BIG_QUERY:case t.WRAPPER_HANDLERS.CLICK_HOUSE:}return{...i,index:r,id:s.id,columns:s.columns,is_new_schema:!1,schema:s.schema,schema_name:s.schema,table_name:s.name}}),"getWrapperMetaForWrapper",()=>r,"makeValidateRequired",0,e=>{let t=new Set(e.filter(e=>e.required).map(e=>e.name)),a=new Set(Array.from(t).filter(e=>e.includes("."))),s=Array.from(a);return e=>Object.fromEntries(Object.entries(e).flatMap(([e,t])=>Array.isArray(t)?[[e,t],...t.map((t,a)=>[`${e}.${a}`,t])]:[[e,t]]).filter(([e,r])=>{let[i,l]=e.split(".");if(void 0!==l&&t.has(i)&&Object.keys(r).some(e=>a.has(`${i}.${e}`))){let e=s.find(e=>e.startsWith(`${i}.`));return!!e&&!r[e.split(".")[1]]}return t.has(i)&&(Array.isArray(r)?r.length<1:!r)}).map(([e])=>"table_name"===e?[e,"Please provide a name for your table"]:"columns"===e?[e,"Please select at least one column"]:[e,"This field is required"]))},"wrapperMetaComparator",()=>s])},394983,228282,e=>{"use strict";var t=e.i(478902);let a=(0,e.i(388019).default)("SquarePlus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);e.s(["SquarePlus",()=>a],228282);var s=e.i(389959),r=e.i(843778);e.s(["EmptyStatePresentational",0,({icon:e,title:i,description:l,children:n,className:c,iconSize:o=24,iconClassName:d,contentClassName:u})=>{let m=e||a,h=(0,t.jsxs)("div",{className:(0,r.cn)("flex flex-col items-center text-center text-balance",u),children:[(0,t.jsx)("h3",{children:i}),l&&(0,t.jsx)("p",{className:"text-foreground-light text-sm max-w-[640px]",children:l})]});return(0,t.jsxs)("aside",{className:(0,r.cn)("border border-dashed w-full bg-surface-100 rounded-lg px-4 py-10 flex flex-col items-center gap-y-3",c),children:[(0,t.jsxs)("div",{className:"flex flex-col gap-y-3 items-center",children:[(0,s.isValidElement)(m)?m:"function"==typeof m||"object"==typeof m&&null!==m&&"$$typeof"in m?(0,s.createElement)(m,{size:o,strokeWidth:1.5,className:(0,r.cn)("text-foreground-muted",d)}):m,h]}),n]})}],394983)},302372,e=>{"use strict";var t=e.i(242882),a=e.i(248593),s=e.i(234745),r=e.i(635494);e.i(10429);var i=e.i(837508),l=e.i(509847);async function n({projectRef:e,connectionString:t,schema:r},i,l){if(!e)throw Error("projectRef is required");let n=new Headers(l);t&&n.set("x-connection-encrypted",t);let{data:c,error:o}=await (0,s.get)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":t,"x-pg-application-name":a.DEFAULT_PLATFORM_APPLICATION_NAME},path:{ref:e},query:{included_schemas:r||"",excluded_schemas:""}},headers:n,signal:i});return o&&(0,s.handleError)(o),c}e.s(["useDatabasePoliciesQuery",0,({projectRef:e,connectionString:a,schema:s},{enabled:c=!0,...o}={})=>{let{data:d}=(0,r.useSelectedProjectQuery)(),u=d?.status===i.PROJECT_STATUS.ACTIVE_HEALTHY;return(0,t.useQuery)({queryKey:l.databasePoliciesKeys.list(e,s),queryFn:({signal:t})=>n({projectRef:e,connectionString:a,schema:s},t),enabled:c&&void 0!==e&&u,...o})}])},570958,e=>{"use strict";var t=e.i(10429);e.s(["createNavigationHandler",0,(e,a)=>s=>{if("key"in s){("Enter"===s.key||" "===s.key)&&(s.preventDefault(),s.metaKey||s.ctrlKey?window.open(`${t.BASE_PATH}${e}`,"_blank"):a.push(e));return}if("button"in s&&0===s.button&&(s.metaKey||s.ctrlKey)||"button"in s&&1===s.button){s.preventDefault(),window.open(`${t.BASE_PATH}${e}`,"_blank");return}a.push(e)}])},477671,e=>{"use strict";var t=e.i(900843);e.s(["FilesBucket",()=>t.default])},886514,e=>{"use strict";let t=(0,e.i(388019).default)("ArrowDownNarrowWide",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h4",key:"6d7r33"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h10",key:"1438ji"}]]);e.s(["ArrowDownNarrowWide",()=>t],886514)},379565,(e,t,a)=>{var s=e.r(176211),r=e.r(99625),i=e.r(905799),l=e.r(632981),n=e.r(778436),c=e.r(737469);t.exports=function(e,t,a,o){var d=-1,u=r,m=!0,h=e.length,p=[],f=t.length;if(!h)return p;a&&(t=l(t,n(a))),o?(u=i,m=!1):t.length>=200&&(u=c,m=!1,t=new s(t));e:for(;++d<h;){var g=e[d],j=null==a?g:a(g);if(g=o||0!==g?g:0,m&&j==j){for(var x=f;x--;)if(t[x]===j)continue e;p.push(g)}else u(t,j,o)||p.push(g)}return p}},25862,e=>{"use strict";var t=e.i(242882),a=e.i(234745),s=e.i(10429),r=e.i(78162);async function i({projectRef:e},t){if(!e)throw Error("projectRef is required");let{data:s,error:r}=await (0,a.get)("/platform/projects/{ref}/config/storage",{params:{path:{ref:e}},signal:t});return r&&(404===r.code?(0,a.handleError)({...r,message:"Storage configuration not found."}):(0,a.handleError)(r)),s}let l=({projectRef:e},{enabled:a=!0,...l}={})=>(0,t.useQuery)({queryKey:r.configKeys.storage(e),queryFn:({signal:t})=>i({projectRef:e},t),enabled:a&&s.IS_PLATFORM&&void 0!==e,...l});e.s(["useIsAnalyticsBucketsEnabled",0,({projectRef:e})=>{let{data:t}=l({projectRef:e});return!!t?.features.icebergCatalog?.enabled},"useIsVectorBucketsEnabled",0,({projectRef:e})=>{let{data:t}=l({projectRef:e});return!!t?.features.vectorBuckets?.enabled},"useProjectStorageConfigQuery",0,l])},742578,e=>{"use strict";e.s(["vaultSecretsKeys",0,{list:e=>["projects",e,"secrets"],getDecryptedValue:(e,t)=>["projects",e,"secrets",t].filter(Boolean)}])},667954,e=>{"use strict";e.i(967533);var t=e.i(721490),a=e.i(242882),s=e.i(714403),r=e.i(742578);let i=async({projectRef:e,connectionString:a,id:i},l)=>{if(!i)throw Error("ID is required");let n=new t.Query().from("decrypted_secrets","vault").select("decrypted_secret").match({id:i}).toSql(),{result:c}=await (0,s.executeSql)({projectRef:e,connectionString:a,sql:n,queryKey:r.vaultSecretsKeys.getDecryptedValue(e,i)},l);return c},l=async({projectRef:e,connectionString:a,ids:r},i)=>{let l=new t.Query().from("decrypted_secrets","vault").select("id,decrypted_secret").filter("id","in",r).toSql(),{result:n}=await (0,s.executeSql)({projectRef:e,connectionString:a,sql:l},i);return n.reduce((e,t)=>({...e,[t.id]:t.decrypted_secret}),{})};e.s(["getDecryptedValue",0,i,"getDecryptedValues",0,l,"useVaultSecretDecryptedValueQuery",0,({projectRef:e,connectionString:t,id:s},{enabled:l=!0,...n}={})=>(0,a.useQuery)({queryKey:r.vaultSecretsKeys.getDecryptedValue(e,s),queryFn:({signal:a})=>i({projectRef:e,connectionString:t,id:s},a),select:e=>e[0]?.decrypted_secret??"",enabled:l&&void 0!==e&&void 0!==s,...n})])},131629,(e,t,a)=>{var s=e.r(379565),r=e.r(262523),i=e.r(239334),l=e.r(608435);t.exports=i(function(e,t){return l(e)?s(e,r(t,1,l,!0)):[]})},319941,209636,e=>{"use strict";var t=e.i(131629),a=e.i(346428),s=e.i(12214),r=e.i(667954),i=e.i(48189),l=e.i(890265);let n=e=>{let t=0;for(let a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t&=t;return new Uint32Array([t])[0].toString(36)},c=(0,i.createWrappedSymbol)("unknown-bucket","Unknown"),o=(0,i.createWrappedSymbol)("ungrouped-policy","Ungrouped"),d=e=>{if(!e)return null;let[t]=(e?.split(" AND ")??[]).filter(e=>e.includes("bucket_id"));return t?t.split("'")[1]:null},u=()=>(0,a.useRouter)().pathname.split("/")[4],m=async({ref:e,connectionString:t,wrapper:a,wrapperMeta:i})=>{let l=i.server.options,n=(0,s.convertKVStringArrayToJson)(a?.server_options??[]),c=Object.fromEntries(new Map(Object.entries(n).filter(([e,t])=>l.find(t=>t.name===e)?.encrypted))),o=await (0,r.getDecryptedValues)({projectRef:e,connectionString:t,ids:Object.values(c)}),d=Object.fromEntries(new Map(Object.entries(c).map(([e,t])=>[e,o[t]])));return{...n,...d}};e.s(["UNGROUPED_POLICY_SYMBOL",0,o,"applyBucketIdToTemplateDefinition",0,(e,t)=>e.replace("{bucket_id}",`'${t}'`),"createPayloadsForAddPolicy",0,(e="",t,a=!0)=>{let{name:s,definition:r,allowedOperations:i,roles:l}=t,c=r?r.replace(/\s+/g," ").trim():"";return i.map((t,r)=>{var i,o,d,u,m,h,p;let f;return i=r,o=e,d=s,u=c,m=t,h=l,p=a,f=n(o),{name:p?`${d} ${f}_${i}`:d,definition:"INSERT"===m?void 0:`(${u})`,action:"PERMISSIVE",check:"INSERT"===m?`(${u})`:void 0,command:m,schema:"storage",table:"objects",roles:h.length>0?h:void 0}})},"createSQLPolicies",0,(e,t,a=!0)=>{let{name:s,definition:r,allowedOperations:i,roles:l}=t;return i.map((t,i)=>{var c;let o,d,u,m;return c=r||"",o=n(e),d=a?`${s} ${o}_${i}`:s,u=`Add policy for the ${t} operation under the policy "${s}"`,m=0===l.length?["public"]:l,{description:u,statement:`
    CREATE POLICY "${d}"
    ON storage.objects
    FOR ${t}
    TO ${m.join(", ")}
    ${"INSERT"===t?"WITH CHECK":"USING"} (${c});
`.replace(/\s+/g," ").trim()}})},"deriveAllowedClientLibraryMethods",0,(e=[])=>Object.keys(l.STORAGE_CLIENT_LIBRARY_MAPPINGS).filter(a=>{let s=l.STORAGE_CLIENT_LIBRARY_MAPPINGS[a];if(0===(0,t.default)(s,e).length)return a}),"extractBucketNameFromDefinition",0,d,"formatPoliciesForStorage",0,(e,t)=>{var a,s,r;let i,l;return 0===t.length?[]:(r=(a=e,s=t,i=a.map(e=>e.name),s.map(e=>{let{definition:t,check:a}=e,s=null!==t?d(t):d(a);if(s){let t=i.includes(s);return{...e,bucket:t?s:c}}return{...e,bucket:o}})),l=new Map,r.forEach(e=>{l.has(e.bucket)||l.set(e.bucket,[]),l.get(e.bucket)?.push(e)}),Array.from(l).map(([e,t])=>({name:e,policies:t})))},"getDecryptedParameters",0,m,"useStorageV2Page",0,u],319941);var h=e.i(478902),p=e.i(645388);e.i(128328);var f=e.i(86086),g=e.i(158639),j=e.i(25862),x=e.i(912793),b=e.i(587433),y=e.i(862326);let v=()=>{let{ref:e}=(0,g.useParams)(),t=u(),{storageAnalytics:a,storageVectors:s}=(0,x.useIsFeatureEnabled)(["storage:analytics","storage:vectors"]),r=(0,j.useIsAnalyticsBucketsEnabled)({projectRef:e}),i=(0,j.useIsVectorBucketsEnabled)({projectRef:e}),n=Object.entries(l.BUCKET_TYPES).filter(([e])=>"analytics"===e?f.IS_PLATFORM&&a:"vectors"!==e||f.IS_PLATFORM&&s);return(0,h.jsx)(y.Menu,{type:"pills",className:"my-6 flex flex-grow flex-col",children:(0,h.jsxs)("div",{className:"space-y-6",children:[(0,h.jsxs)("div",{className:"mx-3",children:[(0,h.jsx)(y.Menu.Group,{title:(0,h.jsx)("span",{className:"uppercase font-mono",children:"Manage"})}),n.map(([a,s])=>(0,h.jsx)(p.default,{href:`/project/${e}/storage/${a}`,children:(0,h.jsx)(y.Menu.Item,{rounded:!0,active:t===a,children:(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsx)("p",{className:"truncate",children:s.displayName}),("analytics"===a&&r||"vectors"===a&&i)&&(0,h.jsx)(b.Badge,{variant:"success",children:"New"})]})})},a))]}),f.IS_PLATFORM&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"h-px w-full bg-border"}),(0,h.jsxs)("div",{className:"mx-3",children:[(0,h.jsx)(y.Menu.Group,{title:(0,h.jsx)("span",{className:"uppercase font-mono",children:"Configuration"})}),(0,h.jsx)(p.default,{href:`/project/${e}/storage/s3`,children:(0,h.jsx)(y.Menu.Item,{rounded:!0,active:"s3"===t,children:(0,h.jsx)("p",{className:"truncate",children:"S3"})})})]})]})]})})};var _=e.i(951138),k=e.i(825713);let P=(0,_.withAuth)(({title:e,children:t})=>(0,h.jsx)(k.ProjectLayout,{title:e||"Storage",product:"Storage",productMenu:(0,h.jsx)(v,{}),children:t}));e.s(["default",0,P],209636)},904987,e=>{"use strict";var t=e.i(478902),a=e.i(645388);e.i(128328);var s=e.i(86086),r=e.i(158639),i=e.i(890265),l=e.i(319941),n=e.i(513826),c=e.i(418091),o=e.i(547723),d=e.i(456050);e.s(["StorageBucketsLayout",0,({title:e,hideSubtitle:u=!1,children:m})=>{let{ref:h}=(0,r.useParams)(),p=(0,c.usePathname)(),f=(0,l.useStorageV2Page)(),g=f&&"s3"!==f?i.BUCKET_TYPES[f]:void 0,j="files"===f?[{label:"Buckets",href:`/project/${h}/storage/files`},...s.IS_PLATFORM?[{label:"Settings",href:`/project/${h}/storage/files/settings`}]:[],{label:"Policies",href:`/project/${h}/storage/files/policies`}]:[];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.PageHeader,{children:[(0,t.jsxs)(d.PageHeaderMeta,{children:[(0,t.jsxs)(d.PageHeaderSummary,{children:[(0,t.jsx)(d.PageHeaderTitle,{children:e||(g?.displayName??"Storage")}),!u&&(0,t.jsx)(d.PageHeaderDescription,{children:g?.description||"Manage your storage buckets and files."})]}),(0,t.jsx)(d.PageHeaderAside,{children:g?.docsUrl&&(0,t.jsx)(n.DocsButton,{href:g.docsUrl},"docs")})]}),j.length>0&&(0,t.jsx)(d.PageHeaderNavigationTabs,{children:(0,t.jsx)(o.NavMenu,{children:j.map(e=>(0,t.jsx)(o.NavMenuItem,{active:p===e.href,children:(0,t.jsx)(a.default,{href:e.href,children:e.label})},e.label))})})]}),m]})}])},608907,572349,e=>{"use strict";var t=e.i(478902);e.i(481541);var a=e.i(129449),a=a,s=e.i(394983),r=e.i(934302),i=e.i(479232),l=e.i(215312),n=e.i(2579);let c=({onClick:e})=>{let{can:a}=(0,n.useAsyncCheckPermissions)(r.PermissionAction.STORAGE_WRITE,"*");return(0,t.jsx)(l.ButtonTooltip,{block:!0,size:"tiny",type:"primary",className:"w-fit",icon:(0,t.jsx)(i.Plus,{size:14}),disabled:!a,onClick:e,tooltip:{content:{side:"bottom",text:a?void 0:"You need additional permissions to create buckets"}},children:"New bucket"})};e.s(["CreateBucketButton",0,c],572349);var o=e.i(890265);e.s(["EmptyBucketState",0,({bucketType:e,className:r,onCreateBucket:i})=>{let l=o.BUCKET_TYPES[e];return(0,t.jsx)(s.EmptyStatePresentational,{icon:a.default,title:`Create ${l.article} ${l.singularName} bucket`,description:l.valueProp,className:r,children:(0,t.jsx)(c,{onClick:i})})}],608907)},649068,e=>{"use strict";let t="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;e.s(["DEBUG_BUILD",()=>t])},657938,e=>{"use strict";var t=e.i(389959),a=e.i(319941),s=e.i(302372),r=e.i(635494);function i(){let{data:e,isPending:i}=(0,r.useSelectedProjectQuery)(),{data:l=[],isPending:n}=(0,s.useDatabasePoliciesQuery)({projectRef:e?.ref,connectionString:e?.connectionString,schema:"storage"}),c=(0,t.useMemo)(()=>{let e=new Map;for(let t of l){if("objects"!==t.table)continue;let s=(0,a.extractBucketNameFromDefinition)(t.definition)??(0,a.extractBucketNameFromDefinition)(t.check);s&&e.set(s,(e.get(s)??0)+1)}return e},[l]);return{getPolicyCount:(0,t.useCallback)(e=>c.get(e)??0,[c]),isLoading:i||n}}e.s(["useBucketPolicyCount",()=>i])},672296,e=>{"use strict";function t(e){return e.split("#")[0]}function a(e,t={}){let{maxDepth:s=3,redaction:r="[REDACTED]",truncationNotice:i="[REDACTED: max depth reached]",sensitiveKeys:l=[]}=t,n=new Set(["password","passwd","pwd","pass","secret","token","id_token","access_token","refresh_token","apikey","api_key","api-key","apiKey","key","privatekey","private_key","client_secret","clientSecret","auth","authorization","ssh_key","sshKey","bearer","session","cookie","csrf","xsrf","ip","ip_address","ipAddress","aws_access_key_id","aws_secret_access_key","gcp_service_account_key",...l].map(e=>e.toLowerCase())),c=[{re:/\b(?:(?:25[0-5]|2[0-4]\d|1?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|1?\d?\d)\b/g,reason:"ip"},{re:/\b(?:[A-Fa-f0-9]{1,4}:){2,7}[A-Fa-f0-9]{1,4}\b/g,reason:"ip6"},{re:/\b(AKI|ASI)A[0-9A-Z]{16}\b/g,reason:"aws_access_key_id"},{re:/\b[0-9A-Za-z/+]{40}\b/g,reason:"aws_secret_access_key_like"},{re:/\bBearer\s+[A-Za-z0-9\-._~+/]+=*\b/g,reason:"bearer"},{re:/\b[A-Za-z0-9-_]+?\.[A-Za-z0-9-_]+?\.[A-Za-z0-9-_]+?\b/g,reason:"jwt_like"},{re:/\b[A-Za-z0-9_\-]{24,64}\b/g,reason:"long_token"}],o=new WeakMap;function d(e){let t=e;for(let{re:e}of c)t=t.replace(e,r);return t}function u(e){return n.has(String(e).toLowerCase())}return e.map(e=>(function e(t,a){if(null==t||"number"==typeof t||"boolean"==typeof t||"bigint"==typeof t)return t;if("string"==typeof t)return d(t);if("function"==typeof t)return"[Function]";if(t instanceof Date)return t.toISOString();if(t instanceof RegExp)return t.toString();if(ArrayBuffer.isView(t)&&!(t instanceof DataView))return`[TypedArray byteLength=${t.byteLength}]`;if(t instanceof ArrayBuffer)return`[ArrayBuffer byteLength=${t.byteLength}]`;if(a>=s)return i;if("object"==typeof t){if(o.has(t))return"[Circular]";if(Array.isArray(t)){let s=[];o.set(t,s);for(let r=0;r<t.length;r++)s[r]=e(t[r],a+1);return s}if(function(e){if(null===e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}(t)){let s={};for(let[i,l]of(o.set(t,s),Object.entries(t)))u(i)?s[i]=r:s[i]=e(l,a+1);return s}if(t instanceof Map){let s=[];for(let[i,l]of(o.set(t,s),t.entries())){let t=u(i)?r:e(i,a+1),n=u(i)?r:e(l,a+1);s.push([t,n])}return s}if(t instanceof Set){let s=[];for(let r of(o.set(t,s),t.values()))s.push(e(r,a+1));return s}if(t instanceof URL)return t.toString();if(t instanceof Error){let e={name:t.name,message:d(t.message),stack:i};return o.set(t,e),e}try{return d(String(t))}catch{return d(Object.prototype.toString.call(t))}}return d(String(t))})(e,0))}e.s(["sanitizeArrayOfObjects",()=>a,"sanitizeUrlHashParams",()=>t])},936919,e=>{"use strict";var t=e.i(478902),a=e.i(202584),s=e.i(886514),r=e.i(366652),i=e.i(389959);e.i(128328);var l=e.i(158639),n=e.i(567558),c=e.i(937942),o=e.i(25862),d=e.i(34231),u=e.i(10429),m=e.i(48189),h=e.i(645974),p=e.i(884346),f=e.i(837710),g=e.i(627069),j=e.i(874311),x=e.i(710483),b=e.i(746301),y=e.i(127739),v=e.i(228027),_=e.i(108151),k=e.i(532728),P=e.i(408891),S=e.i(355901),w=e.i(417403),N=e.i(870354),C=e.i(38429),A=e.i(356003),R=e.i(234745),E=e.i(937163);async function T({projectRef:e,id:t,type:a,isPublic:s,file_size_limit:r,allowed_mime_types:i}){if(!e)throw Error("projectRef is required");if(!t)throw Error("Bucket name is required");let l={id:t,type:a,public:s};"STANDARD"===a&&(r&&(l.file_size_limit=r),i&&(l.allowed_mime_types=i));let{data:n,error:c}=await (0,R.post)("/platform/storage/{ref}/buckets",{params:{path:{ref:e}},body:l});return c&&(0,R.handleError)(c),n}var B=e.i(162082),I=e.i(265735),M=e.i(253214),z=e.i(428353),L=e.i(24315),D=e.i(61863),F=e.i(846887),O=e.i(378277),$=e.i(449123),H=e.i(451031),U=e.i(831927),V=e.i(156722),K=e.i(719754),q=e.i(290811),G=e.i(538482),W=e.i(275226),Q=e.i(146217);let Y=w.default.object({name:w.default.string().trim().min(1,"Please provide a name for your bucket").max(100,"Bucket name should be below 100 characters").refine(e=>!e.endsWith(" "),"The name of the bucket cannot end with a whitespace").refine(e=>"public"!==e,'"public" is a reserved name. Please choose another name'),public:w.default.boolean().default(!1),has_file_size_limit:w.default.boolean().default(!1),formatted_size_limit:w.default.coerce.number().min(0,"File size upload limit has to be at least 0").optional(),allowed_mime_types:w.default.string().trim().default("")}).superRefine((e,t)=>{if(!W.validBucketNameRegex.test(e.name)){let[a]=e.name.match(W.inverseValidBucketNameRegex)??[];t.addIssue({path:["name"],code:w.default.ZodIssueCode.custom,message:a?`Bucket name cannot contain the "${a}" character`:"Bucket name contains an invalid special character"})}}),Z="create-storage-bucket-form",J=({open:e,onOpenChange:a})=>{let{ref:s}=(0,l.useParams)(),{data:r}=(0,I.useSelectedOrganizationQuery)(),[n,d]=(0,i.useState)(N.StorageSizeUnits.MB),[m,h]=(0,i.useState)(!1),{data:p}=(0,o.useProjectStorageConfigQuery)({projectRef:s},{enabled:u.IS_PLATFORM}),{value:g,unit:j}=(0,Q.convertFromBytes)(p?.fileSizeLimit??0),b=`${g} ${j}`,{mutate:y}=(0,B.useSendEventMutation)(),{mutateAsync:v,isPending:_}=(({onSuccess:e,onError:t,...a}={})=>{let s=(0,A.useQueryClient)();return(0,C.useMutation)({mutationFn:e=>T(e),async onSuccess(t,a,r){let{projectRef:i}=a;await s.invalidateQueries({queryKey:E.storageKeys.buckets(i)}),await e?.(t,a,r)},async onError(e,a,s){void 0===t?S.toast.error(`Failed to create bucket: ${e.message}`):t(e,a,s)},...a})})({onError:()=>{}}),w=(0,P.useForm)({resolver:(0,k.zodResolver)(Y),defaultValues:{name:"",public:!1,has_file_size_limit:!1,formatted_size_limit:void 0,allowed_mime_types:""}}),{formatted_size_limit:R}=w.formState.errors,W=w.watch("public"),J=w.watch("has_file_size_limit"),X=async e=>{if(!s)return console.error("Project ref is required");try{let t=e.has_file_size_limit&&void 0!==e.formatted_size_limit?(0,Q.convertToBytes)(e.formatted_size_limit,n):void 0,i=m&&e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):void 0;if(t&&p?.fileSizeLimit&&t>p.fileSizeLimit)return w.setError("formatted_size_limit",{type:"manual",message:"exceed_global_limit"});await v({projectRef:s,id:e.name,type:"STANDARD",isPublic:e.public,file_size_limit:t,allowed_mime_types:i}),y({action:"storage_bucket_created",properties:{bucketType:"STANDARD"},groups:{project:s??"Unknown",organization:r?.slug??"Unknown"}}),S.toast.success(`Successfully created bucket ${e.name}`),w.reset(),d(N.StorageSizeUnits.MB),a(!1)}catch(t){let e=t.message?.toLowerCase()||"";e.includes("mime type")&&(e.includes("is not supported")||e.includes("not supported"))?w.setError("allowed_mime_types",{type:"manual",message:"Invalid MIME type format. Please check your input."}):S.toast.error(`Failed to create bucket: ${t.message}`)}};return(0,t.jsx)(M.Dialog,{open:e,onOpenChange:e=>{e||(w.reset(),d(N.StorageSizeUnits.MB),a(!1))},children:(0,t.jsxs)(M.DialogContent,{"aria-describedby":void 0,children:[(0,t.jsx)(M.DialogHeader,{children:(0,t.jsx)(M.DialogTitle,{children:"Create file bucket"})}),(0,t.jsx)(M.DialogSectionSeparator,{}),(0,t.jsx)(z.Form_Shadcn_,{...w,children:(0,t.jsxs)("form",{id:Z,onSubmit:w.handleSubmit(X),children:[(0,t.jsx)(M.DialogSection,{className:"flex flex-col gap-y-2",children:(0,t.jsx)(D.FormField_Shadcn_,{name:"name",control:w.control,render:({field:e})=>(0,t.jsx)(G.FormItemLayout,{name:"name",label:"Bucket name",labelOptional:"Cannot be changed after creation",children:(0,t.jsx)(L.FormControl_Shadcn_,{children:(0,t.jsx)(O.Input_Shadcn_,{id:"name","data-1p-ignore":!0,"data-lpignore":"true","data-form-type":"other","data-bwignore":!0,...e,placeholder:"Enter bucket name"})})})},"name")}),(0,t.jsx)(M.DialogSectionSeparator,{}),(0,t.jsxs)(M.DialogSection,{className:"space-y-3",children:[(0,t.jsx)(D.FormField_Shadcn_,{name:"public",control:w.control,render:({field:e})=>(0,t.jsx)(G.FormItemLayout,{hideMessage:!0,name:"public",label:"Public bucket",description:"Allow anyone to read objects without authorization",layout:"flex",children:(0,t.jsx)(L.FormControl_Shadcn_,{children:(0,t.jsx)(q.Switch,{id:"public",size:"large",checked:e.value,onCheckedChange:e.onChange})})})},"public"),W&&(0,t.jsx)(x.Admonition,{type:"warning",title:"Public buckets are not protected",description:"Users can read objects in public buckets without any authorization. Row level security (RLS) policies are still required for other operations such as object uploads and deletes."})]}),(0,t.jsx)(M.DialogSectionSeparator,{}),(0,t.jsxs)(M.DialogSection,{className:"space-y-2",children:[(0,t.jsx)(D.FormField_Shadcn_,{name:"has_file_size_limit",control:w.control,render:({field:e})=>(0,t.jsx)(G.FormItemLayout,{name:"has_file_size_limit",label:"Restrict file size",description:"Prevent uploading of files larger than a specified limit",layout:"flex",children:(0,t.jsx)(L.FormControl_Shadcn_,{children:(0,t.jsx)(q.Switch,{id:"has_file_size_limit",size:"large",checked:e.value,onCheckedChange:e.onChange})})})},"has_file_size_limit"),J&&(0,t.jsxs)("div",{children:[(0,t.jsx)(D.FormField_Shadcn_,{name:"formatted_size_limit",control:w.control,render:({field:e})=>(0,t.jsx)(G.FormItemLayout,{hideMessage:!0,name:"formatted_size_limit",label:"File size limit",children:(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-x-2",children:[(0,t.jsx)("div",{className:"col-span-8",children:(0,t.jsx)(L.FormControl_Shadcn_,{children:(0,t.jsx)(O.Input_Shadcn_,{id:"formatted_size_limit","aria-label":"File size limit",type:"number",min:0,placeholder:"0",...e})})}),(0,t.jsx)("div",{className:"col-span-4",children:(0,t.jsxs)($.Select_Shadcn_,{value:n,onValueChange:d,children:[(0,t.jsx)(V.SelectTrigger_Shadcn_,{"aria-label":"File size limit unit",size:"small",children:(0,t.jsx)(K.SelectValue_Shadcn_,{children:n})}),(0,t.jsx)(H.SelectContent_Shadcn_,{children:Object.values(N.StorageSizeUnits).map(e=>(0,t.jsx)(U.SelectItem_Shadcn_,{value:e,className:"text-xs",children:e},e))})]})})]})})},"formatted_size_limit"),R?.message==="exceed_global_limit"&&(0,t.jsxs)(F.FormMessage_Shadcn_,{className:"mt-2",children:["Exceeds global limit of ",b,". Increase limit in"," ",(0,t.jsx)(c.InlineLink,{className:"text-destructive decoration-destructive-500 hover:decoration-destructive",href:`/project/${s}/storage/settings`,onClick:()=>a(!1),children:"Storage Settings"})," ","first."]}),u.IS_PLATFORM&&(0,t.jsxs)("p",{className:"text-sm text-foreground-lighter mt-2",children:["This project has a"," ",(0,t.jsx)(c.InlineLink,{className:"text-foreground-light hover:text-foreground",href:`/project/${s}/storage/settings`,onClick:()=>a(!1),children:"global file size limit"})," ","of ",b,"."]})]})]}),(0,t.jsx)(M.DialogSectionSeparator,{}),(0,t.jsxs)(M.DialogSection,{className:"space-y-2",children:[(0,t.jsx)(G.FormItemLayout,{name:"has_allowed_mime_types",label:"Restrict MIME types",description:"Allow only certain types of files to be uploaded",layout:"flex",children:(0,t.jsx)(L.FormControl_Shadcn_,{children:(0,t.jsx)(q.Switch,{id:"has_allowed_mime_types",size:"large",checked:m,onCheckedChange:h})})}),m&&(0,t.jsx)(D.FormField_Shadcn_,{name:"allowed_mime_types",control:w.control,render:({field:e})=>(0,t.jsx)(G.FormItemLayout,{name:"allowed_mime_types",label:"Allowed MIME types",labelOptional:"Comma separated values",description:"Wildcards are allowed, e.g. image/*.",children:(0,t.jsx)(L.FormControl_Shadcn_,{children:(0,t.jsx)(O.Input_Shadcn_,{id:"allowed_mime_types",...e,placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc"})})})},"allowed_mime_types")]})]})}),(0,t.jsxs)(M.DialogFooter,{children:[(0,t.jsx)(f.Button,{type:"default",disabled:_,onClick:()=>a(!1),children:"Cancel"}),(0,t.jsx)(f.Button,{form:Z,htmlType:"submit",loading:_,disabled:_,children:"Create"})]})]})})};var X=e.i(608907),ee=e.i(572349),et=e.i(890265),ea=e.i(431810),es=e.i(117672),er=e.i(843778),ei=e.i(492418);let el=(0,i.createContext)(null),en=({scrollContainerProps:e,scrollContainerRef:a,containerProps:s,data:r,children:l,overscan:n=5,estimateSize:c,getItemKey:o,...d})=>{let u=(0,i.useRef)(null),m=(0,es.mergeRefs)(u,a),h=(0,i.useCallback)((e,t)=>o?o(e,t):t,[o]),p=(0,i.useCallback)(e=>{let t=r[e];return t?h(t,e):e},[r,h]),f=(0,ea.useVirtualizer)({count:r.length,getScrollElement:()=>u.current,overscan:n,estimateSize:c,getItemKey:p}),g=f.getVirtualItems(),j=f.getTotalSize(),x=g.length>0?g[0].start:0,b=g.length>0?j-g[g.length-1].end:0,y=(0,i.useMemo)(()=>({virtualizer:f,virtualItems:g,data:r,paddingTop:x,paddingBottom:b,getRowKey:h}),[f,g,r,x,b,h]),v=(0,i.useMemo)(()=>({...s,className:(0,er.cn)("overflow-visible",s?.className)}),[s]),{className:_,...k}=e??{};return(0,t.jsx)("div",{ref:m,className:(0,er.cn)("h-full overflow-auto",_),...k,children:(0,t.jsx)(el.Provider,{value:y,children:(0,t.jsx)(ei.Table,{containerProps:v,...d,children:l})})})},ec=({emptyContent:e,leadingContent:a,trailingContent:s,children:r,paddingColSpan:l=1,paddingCellClassName:n,...c})=>{let{virtualizer:o,virtualItems:d,data:u,paddingTop:m,paddingBottom:h,getRowKey:p}=(()=>{let e=(0,i.useContext)(el);if(!e)throw Error("VirtualizedTable components must be used within a VirtualizedTable");return e})(),f=o.measureElement;return(0,t.jsxs)(ei.TableBody,{...c,children:[a,0===u.length?e??null:(0,t.jsxs)(t.Fragment,{children:[m>0&&(0,t.jsx)(ei.TableRow,{"aria-hidden":"true",style:{height:m},children:(0,t.jsx)(em,{colSpan:l,className:(0,er.cn)("p-0",n)})}),d.map(e=>{let t=u[e.index];if(void 0===t)return null;let a=r(t,e.index);if(!(0,i.isValidElement)(a))return a;let s=a.key??p(t,e.index),l=a.ref,n=null!=l?(0,es.mergeRefs)(f,l):f;return(0,i.cloneElement)(a,{key:s,ref:n,"data-index":e.index})}),h>0&&(0,t.jsx)(ei.TableRow,{"aria-hidden":"true",style:{height:h},children:(0,t.jsx)(em,{colSpan:l,className:(0,er.cn)("p-0",n)})})]}),s]})},eo=ei.TableHeader,ed=(0,i.forwardRef)(({className:e,...a},s)=>(0,t.jsx)(ei.TableHead,{ref:s,className:(0,er.cn)("sticky top-0 z-10 bg-200",e),...a}));ed.displayName="VirtualizedTableHead";let eu=ei.TableRow,em=ei.TableCell;ei.TableFooter,ei.TableCaption;var eh=e.i(657938);e.i(481541);var ep=e.i(477671),ef=e.i(570958),eg=e.i(416050),ej=e.i(418091),ex=e.i(587433);let eb=({mode:e,hasBuckets:a=!0})=>{let s="standard"===e?ei.TableHeader:eo,r="standard"===e?ei.TableRow:eu,i="standard"===e?ei.TableHead:ed,l="sticky top-0 z-10 bg-200";return(0,t.jsx)(s,{children:(0,t.jsxs)(r,{children:[a&&(0,t.jsx)(i,{className:`${l} w-2 pr-1`,children:(0,t.jsx)("span",{className:"sr-only",children:"Icon"})}),(0,t.jsx)(i,{className:l,children:"Name"}),(0,t.jsx)(i,{className:l,children:"Policies"}),(0,t.jsx)(i,{className:l,children:"File size limit"}),(0,t.jsx)(i,{className:l,children:"Allowed MIME types"}),(0,t.jsx)(i,{className:l,children:(0,t.jsx)("span",{className:"sr-only",children:"Actions"})})]})})},ey=({mode:e,filterString:a})=>{let s="standard"===e?ei.TableRow:eu,r="standard"===e?ei.TableCell:em;return(0,t.jsx)(s,{className:"[&>td]:hover:bg-inherit",children:(0,t.jsxs)(r,{colSpan:5,children:[(0,t.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,t.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["Your search for “",a,"” did not return any results"]})]})})},ev=({mode:e,bucket:a,projectRef:s,formattedGlobalUploadLimit:r})=>{let i=(0,ej.useRouter)(),{getPolicyCount:l}=(0,eh.useBucketPolicyCount)(),n="standard"===e?ei.TableRow:eu,c="standard"===e?ei.TableCell:em,o=(0,ef.createNavigationHandler)(`/project/${s}/storage/files/buckets/${encodeURIComponent(a.id)}`,i);return(0,t.jsxs)(n,{"data-bucket-id":a.id,className:"relative cursor-pointer h-16 group inset-focus",onClick:o,onAuxClick:o,onKeyDown:o,tabIndex:0,children:[(0,t.jsx)(c,{className:"w-2 pr-1",children:(0,t.jsx)(ep.FilesBucket,{"aria-label":"bucket icon",size:16,className:"text-foreground-muted"})}),(0,t.jsx)(c,{className:"flex-1",children:(0,t.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,t.jsx)("p",{className:"whitespace-nowrap max-w-[512px] truncate",children:a.id}),a.public&&(0,t.jsx)(ex.Badge,{variant:"warning",children:"Public"})]})}),(0,t.jsx)(c,{children:(0,t.jsx)("p",{className:"text-foreground-light",children:l(a.id)})}),(0,t.jsx)(c,{children:(0,t.jsx)("p",{className:`whitespace-nowrap ${a.file_size_limit?"text-foreground-light":"text-foreground-muted"}`,children:a.file_size_limit?(0,m.formatBytes)(a.file_size_limit):`Unset (${r})`})}),(0,t.jsx)(c,{children:(0,t.jsx)("p",{className:a.allowed_mime_types?"text-foreground-light":"text-foreground-muted",children:a.allowed_mime_types?a.allowed_mime_types.join(", "):"Any"})}),(0,t.jsxs)(c,{children:[(0,t.jsx)("div",{className:"flex justify-end items-center h-full",children:(0,t.jsx)(eg.ChevronRight,{"aria-hidden":!0,size:14,className:"text-foreground-muted/60"})}),(0,t.jsx)("button",{tabIndex:-1,className:"sr-only",children:"Go to bucket details"})]})]},a.id)},e_=({mode:e,colSpan:s,hasMore:r=!1,isLoadingMore:l=!1,onLoadMore:n})=>{let[c,o]=(0,a.useIntersectionObserver)({threshold:0,rootMargin:"200px 0px 200px 0px"});if((0,i.useEffect)(()=>{o?.isIntersecting&&r&&!l&&n?.()},[o?.isIntersecting,r,l,n]),!r&&!l)return null;let d="standard"===e?ei.TableRow:eu,u="standard"===e?ei.TableCell:em;return(0,t.jsx)(d,{ref:c,children:Array.from({length:s},(e,a)=>(0,t.jsx)(u,{children:0!==a&&a!==s-1&&(0,t.jsx)(_.ShimmeringLoader,{className:"w-3/4"})},a))})},ek=e=>e.buckets.length>50?(0,t.jsx)(eS,{...e}):(0,t.jsx)(eP,{...e}),eP=({buckets:e,projectRef:a,filterString:s,formattedGlobalUploadLimit:r,pagination:{hasMore:i=!1,isLoadingMore:l=!1,onLoadMore:n}})=>{let c=0===e.length&&s.length>0;return(0,t.jsxs)(ei.Table,{containerProps:{containerClassName:"h-full overflow-auto",className:"overflow-visible"},children:[(0,t.jsx)(eb,{mode:"standard",hasBuckets:e.length>0}),(0,t.jsxs)(ei.TableBody,{children:[c?(0,t.jsx)(ey,{mode:"standard",filterString:s}):e.map(e=>(0,t.jsx)(ev,{mode:"standard",bucket:e,projectRef:a,formattedGlobalUploadLimit:r},e.id)),(0,t.jsx)(e_,{mode:"standard",colSpan:6,hasMore:i,isLoadingMore:l,onLoadMore:n})]})]})},eS=({buckets:e,projectRef:a,filterString:s,formattedGlobalUploadLimit:r,pagination:{hasMore:l=!1,isLoadingMore:n=!1,onLoadMore:c}})=>{let o=0===e.length&&s.length>0,d=(0,i.useRef)(null);return(0,t.jsxs)(en,{data:e,estimateSize:()=>59,getItemKey:e=>e.id,scrollContainerRef:d,children:[(0,t.jsx)(eb,{mode:"virtualized",hasBuckets:e.length>0}),(0,t.jsx)(ec,{paddingColSpan:5,emptyContent:o?(0,t.jsx)(ey,{mode:"virtualized",filterString:s}):void 0,trailingContent:(0,t.jsx)(e_,{mode:"virtualized",colSpan:6,hasMore:l,isLoadingMore:n,onLoadMore:c}),children:e=>(0,t.jsx)(ev,{mode:"virtualized",bucket:e,projectRef:a,formattedGlobalUploadLimit:r},e.id)})]})},ew=()=>{let{ref:e}=(0,l.useParams)(),k=(0,p.useStorageExplorerStateSnapshot)(),[P,S]=(0,i.useState)(""),w=(0,a.useDebounce)(P,250).trim(),N=k.sortBucket===et.STORAGE_BUCKET_SORT.ALPHABETICAL?"name":"created_at",C=k.sortBucket===et.STORAGE_BUCKET_SORT.ALPHABETICAL?"asc":"desc",[A,R]=(0,h.useQueryState)("new",h.parseAsBoolean.withDefault(!1).withOptions({history:"push",clearOnDefault:!0})),{data:E}=(0,o.useProjectStorageConfigQuery)({projectRef:e},{enabled:u.IS_PLATFORM}),{data:T,error:B,isError:I,isPending:M,isSuccess:z,isFetching:L,fetchNextPage:D,hasNextPage:F}=(0,d.usePaginatedBucketsQuery)({projectRef:e,search:w.length>0?w:void 0,sortColumn:N,sortOrder:C}),O=(0,i.useMemo)(()=>T?.pages.flatMap(e=>e)??[],[T]).filter(e=>!("type"in e)||"STANDARD"===e.type),$=0===O.length&&0===w.length,H=(0,m.formatBytes)(E?.fileSizeLimit??0),U=I&&B.message.includes("Project has no active API keys"),V=(0,i.useCallback)(()=>{F&&!L&&D()},[F,L,D]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.PageContainer,{children:(0,t.jsx)(v.PageSection,{children:(0,t.jsxs)(v.PageSectionContent,{className:"h-full gap-y-4",children:[M&&(0,t.jsx)(_.GenericSkeletonLoader,{}),I&&(0,t.jsx)(t.Fragment,{children:U?(0,t.jsx)(x.Admonition,{type:"warning",title:"Project has no active API keys enabled",children:(0,t.jsxs)("p",{className:"!leading-normal text-sm",children:["The Dashboard relies on having active API keys on the project to function. If you'd like to use Storage through the Dashboard, create a set of API keys"," ",(0,t.jsx)(c.InlineLink,{href:`/project/${e}/settings/api-keys/new`,children:"here"}),"."]})}):(0,t.jsx)(n.default,{error:B,subject:"Failed to retrieve buckets"})}),z&&(0,t.jsx)(t.Fragment,{children:$?(0,t.jsx)(X.EmptyBucketState,{bucketType:"files",onCreateBucket:()=>R(!0)}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-grow justify-between gap-x-2 items-center mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,t.jsx)(b.Input,{size:"tiny",className:"flex-grow lg:flex-grow-0 w-52",placeholder:"Search for a bucket",value:P,onChange:e=>S(e.target.value),icon:(0,t.jsx)(r.Search,{})}),(0,t.jsxs)(j.DropdownMenu,{children:[(0,t.jsx)(j.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(f.Button,{type:"default",icon:(0,t.jsx)(s.ArrowDownNarrowWide,{}),children:["Sorted by ","alphabetical"===k.sortBucket?"name":"created at"]})}),(0,t.jsx)(j.DropdownMenuContent,{align:"start",className:"w-40",children:(0,t.jsxs)(j.DropdownMenuRadioGroup,{value:k.sortBucket,onValueChange:e=>k.setSortBucket(e),children:[(0,t.jsx)(j.DropdownMenuRadioItem,{value:"alphabetical",children:"Sort by name"}),(0,t.jsx)(j.DropdownMenuRadioItem,{value:"created_at",children:"Sort by created at"})]})})]})]}),(0,t.jsx)(ee.CreateBucketButton,{onClick:()=>R(!0)})]}),(0,t.jsx)(g.Card,{children:(0,t.jsx)(ek,{buckets:O,projectRef:e??"_",filterString:P,formattedGlobalUploadLimit:H,pagination:{hasMore:F,isLoadingMore:L,onLoadMore:V}})})]})})]})})}),(0,t.jsx)(J,{open:A,onOpenChange:R})]})};var eN=e.i(448710),eC=e.i(904987),eA=e.i(209636);let eR=()=>(0,t.jsx)(ew,{});eR.getLayout=e=>(0,t.jsx)(eN.default,{children:(0,t.jsx)(eA.default,{title:"Storage",children:(0,t.jsx)(eC.StorageBucketsLayout,{children:e})})}),e.s(["default",0,eR],936919)},332098,(e,t,a)=>{let s="/project/[ref]/storage/files";(window.__NEXT_P=window.__NEXT_P||[]).push([s,()=>e.r(936919)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([s])})},111410,e=>{e.v(t=>Promise.all(["static/chunks/a428d2b7e6671266.js","static/chunks/92a7c4be60dd12e3.js"].map(t=>e.l(t))).then(()=>t(677146)))},883471,e=>{e.v(t=>Promise.all(["static/chunks/69b2faaedd35af23.js"].map(t=>e.l(t))).then(()=>t(518769)))},929883,e=>{e.v(t=>Promise.all(["static/chunks/6fd253a8b8879e46.js"].map(t=>e.l(t))).then(()=>t(120649)))},763533,e=>{e.v(t=>Promise.all(["static/chunks/66a6e57db35d752a.js"].map(t=>e.l(t))).then(()=>t(938650)))},730314,e=>{e.v(t=>Promise.all(["static/chunks/dcadd9d46d72282e.js","static/chunks/3d87777fedc85724.js","static/chunks/82dddbda1a808189.js","static/chunks/9f1b22cc5cc0244c.js","static/chunks/c974c4c17d9b515a.js","static/chunks/cc8130a84ee9bc2c.css"].map(t=>e.l(t))).then(()=>t(686651)))},753940,e=>{e.v(t=>Promise.all(["static/chunks/046f60a3ac988a54.js"].map(t=>e.l(t))).then(()=>t(478124)))},724565,e=>{e.v(t=>Promise.all(["static/chunks/3ef67abf4c659c0b.js"].map(t=>e.l(t))).then(()=>t(341546)))},591393,e=>{e.v(t=>Promise.all(["static/chunks/e9ad074e72197584.js"].map(t=>e.l(t))).then(()=>t(217383)))},379416,e=>{e.v(t=>Promise.all(["static/chunks/031b0d6330b6fbae.js"].map(t=>e.l(t))).then(()=>t(931066)))},15732,e=>{e.v(t=>Promise.all(["static/chunks/0d5256e667945be4.js"].map(t=>e.l(t))).then(()=>t(760545)))},957083,e=>{e.v(t=>Promise.all(["static/chunks/e7d07ff1ae210964.js"].map(t=>e.l(t))).then(()=>t(667558)))},926327,e=>{e.v(t=>Promise.all(["static/chunks/a5f6425a6c20e9a8.js"].map(t=>e.l(t))).then(()=>t(72947)))},207969,e=>{e.v(t=>Promise.all(["static/chunks/8dd7282c22f923f6.js"].map(t=>e.l(t))).then(()=>t(427328)))},992842,e=>{e.v(t=>Promise.all(["static/chunks/d064a48a1c7cf778.js"].map(t=>e.l(t))).then(()=>t(793794)))},239573,e=>{e.v(t=>Promise.all(["static/chunks/edc5d84148401903.js"].map(t=>e.l(t))).then(()=>t(210246)))},963685,e=>{e.v(t=>Promise.all(["static/chunks/92b20126e5ca0919.js"].map(t=>e.l(t))).then(()=>t(983756)))},665811,e=>{e.v(t=>Promise.all(["static/chunks/44e647523eaf7d10.js"].map(t=>e.l(t))).then(()=>t(544836)))},369256,e=>{e.v(t=>Promise.all(["static/chunks/8296dc618dae72f0.js"].map(t=>e.l(t))).then(()=>t(930239)))},16037,e=>{e.v(t=>Promise.all(["static/chunks/3251b4bc539a554b.js"].map(t=>e.l(t))).then(()=>t(397698)))},616788,e=>{e.v(t=>Promise.all(["static/chunks/c6b81ab43a1d5d23.js"].map(t=>e.l(t))).then(()=>t(7346)))},315750,e=>{e.v(t=>Promise.all(["static/chunks/32c236321136eb7c.js"].map(t=>e.l(t))).then(()=>t(531289)))},460510,e=>{e.v(t=>Promise.all(["static/chunks/d91062943e6a7c30.js"].map(t=>e.l(t))).then(()=>t(276898)))},550265,e=>{e.v(t=>Promise.all(["static/chunks/75ff0e62b8a31d26.js"].map(t=>e.l(t))).then(()=>t(259714)))},830960,e=>{e.v(t=>Promise.all(["static/chunks/b44aa26556fee7df.js"].map(t=>e.l(t))).then(()=>t(882885)))},336744,e=>{e.v(t=>Promise.all(["static/chunks/2b0767b5c008139a.js"].map(t=>e.l(t))).then(()=>t(955268)))},63631,e=>{e.v(t=>Promise.all(["static/chunks/21a4706e1f02d90b.js"].map(t=>e.l(t))).then(()=>t(853630)))},396476,e=>{e.v(t=>Promise.all(["static/chunks/265a0c1d143bd3f1.js"].map(t=>e.l(t))).then(()=>t(62943)))},912072,e=>{e.v(t=>Promise.all(["static/chunks/c17c80e5efc43419.js"].map(t=>e.l(t))).then(()=>t(311301)))},846537,e=>{e.v(t=>Promise.all(["static/chunks/acf3285986dfbd7a.js"].map(t=>e.l(t))).then(()=>t(245201)))},50229,e=>{e.v(t=>Promise.all(["static/chunks/3bcb48bb59845022.js"].map(t=>e.l(t))).then(()=>t(331248)))},263652,e=>{e.v(t=>Promise.all(["static/chunks/aa4006ae66587429.js"].map(t=>e.l(t))).then(()=>t(700224)))},822335,e=>{e.v(t=>Promise.all(["static/chunks/ee69726af0316987.js"].map(t=>e.l(t))).then(()=>t(48216)))},827389,e=>{e.v(t=>Promise.all(["static/chunks/f888750d45a24867.js"].map(t=>e.l(t))).then(()=>t(780795)))},306465,e=>{e.v(t=>Promise.all(["static/chunks/95db3728117c6ee7.js"].map(t=>e.l(t))).then(()=>t(84223)))},320810,e=>{e.v(t=>Promise.all(["static/chunks/f5da8b2852673ce6.js"].map(t=>e.l(t))).then(()=>t(190529)))},44756,e=>{e.v(t=>Promise.all(["static/chunks/fe9cc17dc6466440.js"].map(t=>e.l(t))).then(()=>t(411609)))},77572,e=>{e.v(t=>Promise.all(["static/chunks/881b451403819e35.js"].map(t=>e.l(t))).then(()=>t(550910)))},299015,e=>{e.v(t=>Promise.all(["static/chunks/e771049771127f6f.js"].map(t=>e.l(t))).then(()=>t(956403)))},853832,e=>{e.v(t=>Promise.all(["static/chunks/da4d4a78a31fafb9.js"].map(t=>e.l(t))).then(()=>t(523047)))},444444,e=>{e.v(t=>Promise.all(["static/chunks/f38e028ff72cdce1.js"].map(t=>e.l(t))).then(()=>t(306141)))},89982,e=>{e.v(t=>Promise.all(["static/chunks/7f0708c377c6315e.js"].map(t=>e.l(t))).then(()=>t(84181)))},439,e=>{e.v(t=>Promise.all(["static/chunks/92660c7112298340.js"].map(t=>e.l(t))).then(()=>t(585967)))},674055,e=>{e.v(t=>Promise.all(["static/chunks/7dba2c88da4802d7.js"].map(t=>e.l(t))).then(()=>t(659864)))},801894,e=>{e.v(t=>Promise.all(["static/chunks/aa9037f0686299b0.js"].map(t=>e.l(t))).then(()=>t(532683)))},578444,e=>{e.v(t=>Promise.all(["static/chunks/e8ca73a1fb74d864.js"].map(t=>e.l(t))).then(()=>t(221183)))},185608,e=>{e.v(t=>Promise.all(["static/chunks/3634617ddd98d861.js"].map(t=>e.l(t))).then(()=>t(79472)))},612314,e=>{e.v(t=>Promise.all(["static/chunks/92d2e23f362178b8.js"].map(t=>e.l(t))).then(()=>t(980791)))},660943,e=>{e.v(t=>Promise.all(["static/chunks/c90413a3fb4f7fb4.js"].map(t=>e.l(t))).then(()=>t(620893)))},214615,e=>{e.v(t=>Promise.all(["static/chunks/726c9c09fe01762c.js"].map(t=>e.l(t))).then(()=>t(194742)))},877303,e=>{e.v(t=>Promise.all(["static/chunks/65b0f15c58106291.js"].map(t=>e.l(t))).then(()=>t(85809)))},565731,e=>{e.v(t=>Promise.all(["static/chunks/a857737ee1ea178f.js"].map(t=>e.l(t))).then(()=>t(846526)))},439954,e=>{e.v(t=>Promise.all(["static/chunks/ea2e29758f7a6140.js"].map(t=>e.l(t))).then(()=>t(399358)))},646193,e=>{e.v(t=>Promise.all(["static/chunks/0e86c6f6f44c3d01.js"].map(t=>e.l(t))).then(()=>t(270671)))},470322,e=>{e.v(t=>Promise.all(["static/chunks/95e51d9895d75e1b.js"].map(t=>e.l(t))).then(()=>t(433215)))},310666,e=>{e.v(t=>Promise.all(["static/chunks/c29b3dc53abbda08.js"].map(t=>e.l(t))).then(()=>t(191809)))},38970,e=>{e.v(t=>Promise.all(["static/chunks/10af340af0ab27cf.js"].map(t=>e.l(t))).then(()=>t(66554)))},68365,e=>{e.v(t=>Promise.all(["static/chunks/8229f5f7f1da78d8.js"].map(t=>e.l(t))).then(()=>t(531769)))},705292,e=>{e.v(t=>Promise.all(["static/chunks/055f0ce00306f8fb.js"].map(t=>e.l(t))).then(()=>t(147575)))},736620,e=>{e.v(t=>Promise.all(["static/chunks/fb200c2b93e182d4.js"].map(t=>e.l(t))).then(()=>t(85022)))},101928,e=>{e.v(t=>Promise.all(["static/chunks/b11be5a5365b7b1d.js"].map(t=>e.l(t))).then(()=>t(846161)))},41375,e=>{e.v(t=>Promise.all(["static/chunks/6ce3b68ef69bef0c.js"].map(t=>e.l(t))).then(()=>t(834473)))},715733,e=>{e.v(t=>Promise.all(["static/chunks/1f996c98ffdc95c1.js"].map(t=>e.l(t))).then(()=>t(417897)))},268726,e=>{e.v(t=>Promise.all(["static/chunks/f82819fa16566fe0.js"].map(t=>e.l(t))).then(()=>t(898187)))},740028,e=>{e.v(t=>Promise.all(["static/chunks/104dd8c9c2b519a7.js"].map(t=>e.l(t))).then(()=>t(391060)))}]);

//# debugId=856aee0e-5b80-79cb-d668-3594785590d7
//# sourceMappingURL=4636084f93327740.js.map
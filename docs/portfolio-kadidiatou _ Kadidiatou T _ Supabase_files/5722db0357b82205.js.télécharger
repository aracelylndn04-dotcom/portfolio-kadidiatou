;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="efdb152c-ae30-b333-a0b1-7f6184dbb63e")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,281192,e=>{"use strict";var t=e.i(645974);let s={},r=e=>(0,t.createParser)({parse:t=>t??e,serialize:e=>e||""});function a(){let[e,a]=(0,t.useQueryState)("s",r("")),[l,i]=(0,t.useQueryState)("its",r("")),[n,o]=(0,t.useQueryState)("ite",r("")),[c,d]=(0,t.useQueryState)("log",r("")),[u,m]=(0,t.useQueryState)("f",(0,t.createParser)({parse:e=>{if(!e)return s;try{return JSON.parse(e)}catch(e){return s}},serialize:e=>{if(!e)return"";try{return JSON.stringify(e)}catch(e){return""}}})),x=u||s,h=e=>{a(e||"")},p=e=>{m(e||s)};return{search:e||"",timestampStart:l||"",timestampEnd:n||"",selectedLogId:c||null,filters:x,setSearch:h,setTimeRange:(e,t)=>{i(e||""),o(t||"")},setSelectedLogId:e=>{d(e||"")},setFilters:p,updateFilter:(e,t)=>{p({...x,[e]:t})},reset:()=>{h(""),i(""),o(""),d(""),m(s)}}}e.s(["useLogsUrlState",()=>a])},929478,e=>{"use strict";var t=e.i(478902),s=e.i(224521),r=e.i(88816),a=e.i(389959),l=e.i(938933);let i=(0,a.createContext)({chevronAlign:"left",justified:!0,type:"default"});function n({children:e,className:r,onChange:a,openBehaviour:n="multiple",type:o="default",defaultValue:c,justified:d=!1,chevronAlign:u="left"}){let m=[(0,l.default)("accordion").variants[o].base];return r&&m.push(r),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(s.Root,{type:n,onValueChange:function(e){a&&a(e),e==typeof String&&e.split(" ")},defaultValue:c,className:m.join(" "),children:(0,t.jsx)(i.Provider,{value:{chevronAlign:u,justified:d,type:o,defaultValue:c},children:(0,t.jsx)("div",{children:e})})})})}n.Item=function({children:e,className:n,header:o,id:c,disabled:d}){let u=(0,l.default)("accordion"),[m,x]=(0,a.useState)(!1),{type:h,justified:p,chevronAlign:f}=(0,a.useContext)(i),g=[u.variants[h].trigger];p&&g.push(u.justified),n&&g.push(n);let j=[u.chevron.base,u.chevron.align[f]];return m&&!d&&j.unshift("!rotate-180"),(0,t.jsxs)(s.Item,{value:c,className:u.variants[h].container,disabled:d,onClick:()=>{x(!m)},children:[(0,t.jsxs)(s.Trigger,{className:g.join(" "),children:[o,!d&&(0,t.jsx)(r.ChevronDown,{"aria-hidden":!0,className:j.join(" "),strokeWidth:2})]}),(0,t.jsx)(s.Content,{className:u.variants[h].content,children:(0,t.jsx)("div",{className:u.variants[h].panel,children:e})})]})},e.s(["default",0,n])},216518,e=>{"use strict";let t=(0,e.i(388019).default)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);e.s(["default",()=>t])},890054,e=>{"use strict";var t=e.i(216518);e.s(["EyeOff",()=>t.default])},106579,e=>{"use strict";var t=e.i(478902),s=e.i(616688),r=e.i(88816),a=e.i(816467),l=e.i(786741),i=e.i(655605),n=e.i(755175),o=e.i(586468),c=e.i(389959),d=e.i(355901),u=e.i(645388);e.i(128328);var m=e.i(158639),x=e.i(418091),h=e.i(86086),p=e.i(837710),f=e.i(375761),g=e.i(874311);e.s(["DownloadResultsButton",0,({iconOnly:e=!1,type:j="default",text:v="Export",align:y="start",results:w,fileName:N,onDownloadAsCSV:b,onCopyAsMarkdown:S,onCopyAsJSON:C})=>{let{ref:k}=(0,m.useParams)(),T=(0,x.usePathname)(),_=T?.includes?.("/logs")??!1,R=w.map(e=>{let t={...e};return Object.keys(e).forEach(s=>{"object"==typeof e[s]&&(t[s]=JSON.stringify(e[s]))}),t}),D=(0,c.useMemo)(()=>{if(w){let e=Array.from(w)[0];if(e)return Object.keys(e)}},[w]);return(0,t.jsxs)(g.DropdownMenu,{children:[(0,t.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(p.Button,{type:j,icon:e?(0,t.jsx)(l.Download,{}):void 0,iconRight:e?void 0:(0,t.jsx)(r.ChevronDown,{}),disabled:0===w.length,className:e?"w-7":"",children:!e&&v})}),(0,t.jsxs)(g.DropdownMenuContent,{align:y,className:"w-44",children:[_&&h.IS_PLATFORM&&(0,t.jsx)(g.DropdownMenuItem,{asChild:!0,className:"gap-x-2",children:(0,t.jsxs)(u.default,{href:`/project/${k}/settings/log-drains`,children:[(0,t.jsx)(i.Settings,{size:14}),(0,t.jsx)("p",{children:"Add a Log Drain"})]})}),(0,t.jsxs)(g.DropdownMenuItem,{onClick:()=>{if(navigator){0==R.length&&(0,d.toast)("Results are empty");let e=Object.keys(R[0]),t=R.map(t=>{let s=[];return e.forEach(e=>s.push(t[e])),s}),s=[e].concat(t),r=(0,n.markdownTable)(s);(0,f.copyToClipboard)(r,()=>{d.toast.success("Copied results to clipboard"),S?.()})}},className:"gap-x-2",children:[(0,t.jsx)(a.Copy,{size:14}),(0,t.jsx)("p",{children:"Copy as markdown"})]}),(0,t.jsxs)(g.DropdownMenuItem,{onClick:()=>{if(navigator){if(0===w.length)return(0,d.toast)("Results are empty");(0,f.copyToClipboard)(JSON.stringify(w,null,2),()=>{d.toast.success("Copied results to clipboard"),C?.()})}},className:"gap-x-2",children:[(0,t.jsx)(a.Copy,{size:14}),(0,t.jsx)("p",{children:"Copy as JSON"})]}),(0,t.jsxs)(g.DropdownMenuItem,{className:"gap-x-2",onClick:()=>{let e;return e=new Blob([o.default.unparse(R,{columns:D})],{type:"text/csv;charset=utf-8;"}),void((0,s.default)(e,`${N}.csv`),d.toast.success("Downloading results as CSV"),b?.())},children:[(0,t.jsx)(l.Download,{size:14}),(0,t.jsx)("p",{children:"Download CSV"})]})]})]})}])},783804,e=>{"use strict";var t=e.i(645974);function s(){return(0,t.useQueryState)("log")}e.s(["useSelectedLog",()=>s])},651068,199026,e=>{"use strict";var t,s,r=e.i(478902),a=e.i(934302);e.i(128328);var l=e.i(86086),i=e.i(158639),n=e.i(215312),o=e.i(106579),c=e.i(783804),d=e.i(2579),u=e.i(432478),m=e.i(822574),x=e.i(816467),h=e.i(543851),p=e.i(890054),f=e.i(388298),g=e.i(389959),j=e.i(840645),v=e.i(591385),y=e.i(971131),w=e.i(355901),N=e.i(837710),b=e.i(843778),S=e.i(375761),C=e.i(725805),k=e.i(218786),T=e.i(955909);let _=e=>(0,r.jsxs)(k.RowLayout,{children:[(0,r.jsx)(T.TimestampInfo,{utcTimestamp:e.row.timestamp}),(0,r.jsx)(k.TextFormatter,{className:"w-full",value:e.row.event_message})]}),R=[{name:"default-preview-first-column",key:"default-preview-first-column",renderHeaderCell:()=>null,renderCell:_}],D=[{name:"auth-first-column",key:"auth-first-column",renderHeaderCell:()=>null,renderCell:e=>e.row.level?(0,r.jsxs)(k.RowLayout,{children:[(0,r.jsx)(T.TimestampInfo,{utcTimestamp:e.row.timestamp}),e.row.level&&(0,r.jsx)(k.SeverityFormatter,{value:e.row.level}),(0,r.jsx)(k.TextFormatter,{className:"w-full",value:`${e.row.path?e.row.path+" | ":""}${e.row.msg?.trim()||e.row.event_message}`})]}):_(e)}],F=[{name:"database-api-first-column",key:"database-api-first-column",renderHeaderCell:()=>null,renderCell:e=>e.row.status_code||e.row.method||e.row.path?(0,r.jsxs)(k.RowLayout,{children:[(0,r.jsx)(T.TimestampInfo,{utcTimestamp:e.row.timestamp}),(0,r.jsx)(k.ResponseCodeFormatter,{value:String(e.row.status_code)}),(0,r.jsx)(k.TextFormatter,{value:String(e.row.method)}),(0,r.jsx)(k.TextFormatter,{value:String(e.row.path)})]}):_(e)}],I=[{name:"database-postgres-first-column",key:"database-postgres-first-column",renderHeaderCell:()=>null,renderCell:e=>e.row.error_severity?(0,r.jsxs)(k.RowLayout,{children:[(0,r.jsx)(T.TimestampInfo,{utcTimestamp:e.row.timestamp}),(0,r.jsx)(k.SeverityFormatter,{value:e.row.error_severity}),(0,r.jsx)(k.TextFormatter,{className:"w-full",value:e.row.event_message}),e.row.detail?(0,r.jsx)(k.TextFormatter,{value:e.row.detail}):null,e.row.hint?(0,r.jsx)(k.TextFormatter,{value:e.row.hint}):null]}):_(e)}],O=[{name:"functions-edge-first-column",key:"functions-edge-first-column",renderHeaderCell:()=>null,renderCell:e=>e.row.status_code||e.row.method?(0,r.jsxs)(k.RowLayout,{children:[(0,r.jsx)(T.TimestampInfo,{utcTimestamp:e.row.timestamp}),(0,r.jsx)(k.ResponseCodeFormatter,{value:String(e.row.status_code)}),(0,r.jsx)(k.TextFormatter,{value:String(e.row.method)}),(0,r.jsx)(k.TextFormatter,{value:String(e.row.id)})]}):_(e)}],E=[{name:"functions-logs-first-column",key:"functions-logs-first-column",renderHeaderCell:()=>null,renderCell:e=>e.row.event_type||e.row.level?(0,r.jsxs)(k.RowLayout,{children:[(0,r.jsx)(T.TimestampInfo,{utcTimestamp:e.row.timestamp}),"uncaughtException"===e.row.event_type?(0,r.jsx)(k.SeverityFormatter,{value:e.row.event_type,uppercase:!1}):(0,r.jsx)(k.SeverityFormatter,{value:e.row.level}),(0,r.jsx)(k.TextFormatter,{className:"w-full",value:e.row.event_message})]}):_(e)}];var L=e.i(460988),M=e.i(370410);let P=(0,e.i(388019).default)("MousePointerClick",[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]]);var A=e.i(975924),z=e.i(672044),$=e.i(283606),q=e.i(314805),J=e.i(408279),B=e.i(500850),H=e.i(108151);(t={}).Csharp="CSHARP",t.Dart="DART",t.Javascript="JAVASCRIPT",t.Kotlin="KOTLIN",t.Python="PYTHON",t.Swift="SWIFT";var Q=((s={}).Auth="AUTH",s.Realtime="REALTIME",s.Storage="STORAGE",s);let U=new class extends String{__apiType;value;__meta__;constructor(e,t){super(e),this.value=e,this.__meta__=t}toString(){return this.value}}(`
    query ErrorCodeQuery($code: String!, $service: Service) {
  errors(code: $code, service: $service) {
    nodes {
      code
      service
      message
    }
  }
}
    `);var K=e.i(281192),W=e.i(874311),V=e.i(479095),G=e.i(242882);e.i(715072);var Y=e.i(234745);async function X(e,{variables:t,signal:s}){try{let r=await fetch("https://supabase.com/docs/api/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,variables:t}),signal:s});if(!r.ok)throw Error("Failed network response from Content API");let{data:a,errors:l}=await r.json();if(l)throw l;return a}catch(e){(0,Y.handleError)(e)}}let Z={"\n  query ErrorCodeQuery($code: String!, $service: Service) {\n    errors(code: $code, service: $service) {\n      nodes {\n        code\n        service\n        message\n      }\n    }\n  }\n":U}[`
  query ErrorCodeQuery($code: String!, $service: Service) {
    errors(code: $code, service: $service) {
      nodes {
        code
        service
        message
      }
    }
  }
`]??{};async function ee({code:e,service:t},s){return await X(Z,{variables:{code:e,service:t},signal:s})}var et=e.i(217444),es=e.i(178527),er=e.i(206413),ea=e.i(592360),el=e.i(587433),ei=e.i(29591),ei=ei,en=e.i(253214);let eo=({open:e,onOpenChange:t,errorCode:s,service:a})=>{let{data:l,isPending:i,isSuccess:n,refetch:o}=((e,{enabled:t=!0,...s}={})=>(0,G.useQuery)({queryKey:(({code:e,service:t})=>["content-api","error-codes",{code:e,service:t}])(e),queryFn:({signal:t})=>ee(e,t),enabled:t,...s}))({code:s,service:a},{enabled:e});return(0,r.jsx)(en.Dialog,{open:e,onOpenChange:t,children:(0,r.jsx)(en.DialogContent,{children:(0,r.jsxs)(en.DialogHeader,{children:[(0,r.jsxs)(en.DialogTitle,{className:"mb-4",children:["Help for error code ",(0,r.jsx)("code",{children:s})]}),(0,r.jsxs)(en.DialogDescription,{children:[i&&(0,r.jsx)(ec,{}),n&&(0,r.jsx)(ed,{data:l}),!i&&!n&&(0,r.jsx)(em,{refetch:o})]})]})})})},ec=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(H.ShimmeringLoader,{className:"w-3/4 mb-2"}),(0,r.jsx)(H.ShimmeringLoader,{className:"w-1/2"})]}),ed=({data:e})=>{let t=e?.errors?.nodes?.filter(e=>!!e.message);return t&&0!==t.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"mb-4",children:"Possible explanations for this error:"}),(0,r.jsx)("div",{className:"grid gap-2 grid-cols-[max-content_1fr]",children:t.map(e=>(0,r.jsx)(eu,{...e},`${e.service}-${e.code}`))})]}):(0,r.jsx)(r.Fragment,{children:"No information found for this error code."})},eu=({code:e,service:t,message:s})=>s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(el.Badge,{className:"h-fit",children:t}),(0,r.jsx)("p",{children:s})]}):null,em=({refetch:e})=>(0,r.jsxs)(es.Alert_Shadcn_,{variant:"warning",children:[(0,r.jsx)(et.AlertTriangle,{}),(0,r.jsx)(ea.AlertTitle_Shadcn_,{children:"Lookup failed"}),(0,r.jsxs)(er.AlertDescription_Shadcn_,{children:[(0,r.jsx)("p",{children:"Failed to look up error code help info"}),e&&(0,r.jsx)(ei.Button,{variant:"outline",size:"sm",className:"mt-2",onClick:e,children:"Try again"})]})]}),ex=({value:e,className:t})=>(0,r.jsx)("pre",{className:(0,b.cn)("px-1 bg-surface-300 w-full pt-1 max-w-full border-none text-xs prose-sm transition-all overflow-auto rounded-md whitespace-pre-wrap",t),children:JSON.stringify(e,null,2)}),eh=()=>(0,r.jsx)(V.Separator,{className:"bg-border my-1"}),ep=({keyName:e,value:t,dataTestId:s,path:a})=>{let{setSearch:l}=(0,K.useLogsUrlState)(),[i,n]=(0,g.useState)(!1),o=a?.startsWith("/auth/")?Q.Auth:void 0,c=async(e,{query:t})=>{l(t||"")},d="timestamp"===e||"created_at"===e||"updated_at"===e,u="object"==typeof t&&null!==t,m="status"===e||"status_code"===e,x="method"===e,h="search"===e,p="user_agent"===e,f="event_message"===e,j="path"===e,v=`log-viewer-expanded-${e}`,[y,C]=(0,g.useState)(()=>{try{return JSON.parse(localStorage.getItem(v)??"false")}catch(e){return!1}}),[_,R]=(0,g.useState)(!1);return((0,g.useEffect)(()=>{localStorage.setItem(v,JSON.stringify(y))},[y,v]),u||f)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h3",{className:"text-foreground-lighter text-sm pl-3 py-2",children:e}),(0,r.jsxs)("div",{children:[(0,r.jsx)(ex,{className:(0,b.cn)("px-2.5",{"max-h-[80px]":!y,"max-h-[400px]":y,"py-2":f}),value:t}),!f&&(0,r.jsx)(N.Button,{className:"mt-1 w-full",size:"tiny",type:"outline",onClick:()=>C(!y),children:y?"Collapse":"Expand"})]})]}),(0,r.jsx)(eh,{})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(W.DropdownMenu,{children:[(0,r.jsx)(W.DropdownMenuTrigger,{className:"group w-full","data-testid":s,children:(0,r.jsx)("div",{className:"rounded-md w-full overflow-hidden",children:(0,r.jsxs)("div",{className:(0,b.cn)("flex h-[var(--header-height)] w-full",{"flex-col gap-1.5 h-auto":y,"items-center group-hover:bg-surface-300 gap-4":!y}),children:[(0,r.jsx)("h3",{className:(0,b.cn)("pl-3 text-foreground-lighter text-sm text-left",{"h-[var(--header-height)] flex items-center":y}),children:e}),(0,r.jsx)("div",{className:(0,b.cn)("text-xs flex-1 font-mono text-foreground pr-3",{"max-w-full text-left rounded-md p-2 bg-surface-300 text-xs w-full":y,"truncate text-right":!y,"text-brand-600":_}),children:y?(0,r.jsx)(ex,{value:t}):d?(0,r.jsx)(T.TimestampInfo,{className:"text-sm",utcTimestamp:t}):m||x?(0,r.jsx)("div",{className:"flex items-center gap-1 justify-end",children:(0,r.jsx)(k.ResponseCodeFormatter,{value:t})}):(0,r.jsx)("div",{className:"truncate",children:t})})]})})}),(0,r.jsxs)(W.DropdownMenuContent,{align:"start",children:["error_code"===e&&(0,r.jsx)(W.DropdownMenuItem,{onClick:()=>{n(!0)},children:"More information"}),(0,r.jsxs)(W.DropdownMenuItem,{onClick:()=>{(0,S.copyToClipboard)(String(t),()=>{R(!0),w.toast.success("Copied to clipboard")}),setTimeout(()=>{R(!1)},1e3)},children:["Copy ",e]}),!u&&(0,r.jsxs)(W.DropdownMenuItem,{onClick:()=>{C(!y)},children:[y?"Collapse":"Expand"," value"]}),(x||p||m||j)&&(0,r.jsxs)(W.DropdownMenuItem,{onClick:()=>{c("search-input-change",{query:t})},children:["Search by ",e]}),h?(h&&"string"==typeof t?(t.startsWith("?")?t.slice(1):t).split("&").filter(Boolean):[]).map(e=>(0,r.jsxs)(W.DropdownMenuItem,{onClick:()=>{c("search-input-change",{query:e})},children:["Search by ",e]},e)):null]}),(0,r.jsx)(eh,{})]}),"error_code"===e&&(0,r.jsx)(eo,{open:i,onOpenChange:n,errorCode:String(t),service:o})]})},ef=({log:e})=>{let{timestamp:t,event_message:s,metadata:a,id:l,status:i,...n}=e,o="string"==typeof e.path?e.path:void 0,c=e?.metadata?.[0]?.log_file;return(0,r.jsxs)("div",{"data-testid":"log-selection",className:"p-2 flex flex-col",children:[e?.id&&(0,r.jsx)(ep,{dataTestId:"log-selection-id",keyName:"id",value:e.id},"id"),e?.status&&(0,r.jsx)(ep,{keyName:"status",value:e.status},"status"),e?.timestamp&&(0,r.jsx)(ep,{keyName:"timestamp",value:e.timestamp},"timestamp"),Object.entries(n).map(([e,t])=>(0,r.jsx)(ep,{keyName:e,value:t,path:o},e)),e?.event_message&&(0,r.jsx)(ep,{keyName:"event_message",value:e.event_message},"event_message"),!!c&&(0,r.jsx)(ep,{keyName:"log_file",value:c},"log_file"),e?.metadata&&(0,r.jsx)(ep,{keyName:"metadata",value:e.metadata},"metadata")]})},eg=({log:e,onClose:t,queryType:s,isLoading:a,error:l})=>{let[i,o]=(0,g.useState)(!1);return(0,g.useEffect)(()=>{if(!i)return;let e=setTimeout(()=>o(!1),2e3);return()=>clearTimeout(e)},[i]),(0,r.jsx)("div",{className:"relative flex h-full flex-grow flex-col overflow-y-scroll bg-surface-100 border-t",children:(0,r.jsx)("div",{className:"relative flex-grow flex flex-col h-full",children:(0,r.jsxs)(B.Tabs_Shadcn_,{defaultValue:"details",className:"flex flex-col h-full",children:[(0,r.jsxs)(q.TabsList_Shadcn_,{className:"px-2 pt-2 relative",children:[(0,r.jsx)(J.TabsTrigger_Shadcn_,{className:"px-3",value:"details",children:"Details"}),(0,r.jsx)(J.TabsTrigger_Shadcn_,{disabled:!e,className:"px-3",value:"raw",children:"Raw"}),(0,r.jsxs)("div",{className:"*:px-1.5 *:text-foreground-lighter ml-auto flex gap-1 absolute right-2 top-2",children:[(0,r.jsx)(n.ButtonTooltip,{disabled:!e||a,type:"text",tooltip:{content:{side:"left",text:a?"Loading log...":"Copy as JSON"}},icon:i?(0,r.jsx)(M.Check,{}):(0,r.jsx)(x.Copy,{}),onClick:()=>{o(!0),(0,S.copyToClipboard)(JSON.stringify(e,null,2))}}),(0,r.jsx)(N.Button,{type:"text",onClick:t,children:(0,r.jsx)(A.X,{size:14,strokeWidth:2})})]})]}),(0,r.jsx)("div",{className:"flex-1 h-full",children:a?(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)(H.GenericSkeletonLoader,{})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)($.TabsContent_Shadcn_,{className:"space-y-6 h-full",value:"details",children:(0,r.jsx)(()=>{if(l)return(0,r.jsx)(ev,{error:l});if(!e)return(0,r.jsx)(ej,{});switch(s){case"api":let t=e?.metadata?.[0]?.response?.[0]?.status_code,a=e?.metadata?.[0]?.request?.[0]?.method,i=e?.metadata?.[0]?.request?.[0]?.path,n=e?.metadata?.[0]?.request?.[0]?.search,o=e?.metadata?.[0]?.request?.[0]?.headers[0].user_agent,c=e?.metadata?.[0]?.response?.[0]?.headers?.[0]?.x_sb_error_code,d=(0,L.jwtAPIKey)(e?.metadata)??(0,L.apiKey)(e?.metadata),u=(0,L.role)(e?.metadata),{id:m,metadata:x,timestamp:h,event_message:p,...f}=e,g={id:m,status:t,method:a,path:i,search:n,user_agent:o,timestamp:h,event_message:p,metadata:x,...d?{apikey:d}:null,...c?{error_code:c}:null,...u?{role:u}:null,...f};return(0,r.jsx)(ef,{log:g});case"database":let j=e?.metadata?.[0]?.parsed?.[0]?.hint,v=e?.metadata?.[0]?.parsed?.[0]?.detail,y=e?.metadata?.[0]?.parsed?.[0]?.query,w={...j&&{hint:j},...v&&{detail:v},...y&&{query:y},...e};return(0,r.jsx)(ef,{log:w});default:return(0,r.jsx)(ef,{log:e})}},{})}),(0,r.jsx)($.TabsContent_Shadcn_,{value:"raw",children:(0,r.jsx)(z.CodeBlock,{hideLineNumbers:!0,language:"json",className:"prose w-full pt-0 max-w-full border-none",children:JSON.stringify(e,null,2)})})]})})]})})})};function ej({title:e="Select an Event",message:t="Select an Event to view the complete JSON payload"}){return(0,r.jsx)("div",{className:(0,b.cn)("flex h-full w-full flex-col items-center justify-center gap-2 overflow-y-scroll text-center transition-all px-4"),children:(0,r.jsxs)("div",{className:(0,b.cn)("flex w-full max-w-sm flex-col items-center justify-center gap-6 text-center transition-all delay-300 duration-500"),children:[(0,r.jsxs)("div",{className:"relative flex h-4 w-32 items-center rounded border border-control px-2",children:[(0,r.jsx)("div",{className:"h-0.5 w-2/3 rounded-full bg-surface-300"}),(0,r.jsx)("div",{className:"absolute right-1 -bottom-4",children:(0,r.jsx)(P,{size:"24",strokeWidth:1})})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h3",{className:"text-sm text-foreground",children:e}),(0,r.jsx)("p",{className:"text-xs text-foreground-lighter",children:t})]})]})})}function ev({error:e}){return(0,r.jsx)("pre",{children:JSON.stringify(e,null,2)})}let ey=({error:e})=>(0,r.jsx)("div",{className:"w-full prose min-w-full text-foreground text-sm",children:(0,r.jsx)(z.CodeBlock,{title:"Error fetching logs",language:"json",hideLineNumbers:!0,value:"string"==typeof e?e:JSON.stringify(e,null,2),className:"w-full font-mono"})});var ew=e.i(929478),ew=ew,eN=e.i(171997);let eb=({error:e,isCustomQuery:t})=>(0,r.jsxs)("div",{className:"flex flex-col gap-2 text-foreground-light",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1 text-sm",children:[(0,r.jsx)("p",{children:"This query requires too much memory to be executed."}),(0,r.jsx)("p",{children:t?"Avoid selecting entire objects and instead select specific keys using dot notation.":"Avoid querying across a large datetime range."}),!t&&(0,r.jsx)("p",{children:"Please contact support if this error persists."})]}),(0,r.jsx)(ew.default,{className:"text-sm",justified:!1,openBehaviour:"multiple",type:"default",chevronAlign:"left",size:"small",iconPosition:"left",children:(0,r.jsx)(ew.default.Item,{id:"1",header:"Full error message",children:(0,r.jsx)(eN.Input.TextArea,{size:"tiny",value:JSON.stringify(e,null,2),borderless:!0,className:"mt-4 w-full font-mono",copy:!0,rows:5})})})]});var eS=e.i(366652);let eC=()=>(0,r.jsx)("div",{className:"relative flex h-4 w-32 items-center rounded border border-dashed border-stronger px-2"});function ek({title:e="No results found",description:t="Try another search or adjust the filters"}){return(0,r.jsxs)("div",{className:"flex scale-100 flex-col items-center justify-center gap-6 text-center opacity-100 h-full",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1 relative",children:[(0,r.jsx)(eC,{}),(0,r.jsx)(eC,{}),(0,r.jsx)(eC,{}),(0,r.jsx)(eS.Search,{size:30,className:"absolute right-3 -bottom-2 text-foreground-lighter"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1 px-5",children:[(0,r.jsx)("h3",{className:"text-lg text-foreground",children:e}),(0,r.jsx)("p",{className:"text-sm max-w-xs text-foreground-lighter",children:t})]})]})}e.s(["LogsTableEmptyState",()=>ek],199026),e.s(["LogTable",0,({data:e=[],queryType:t,onHistogramToggle:s,isHistogramShowing:k,isLoading:T,isSaving:_,error:M,projectRef:P,onRun:A,onSave:z,hasEditorValue:$,className:q,EmptyState:J,showHeader:B=!0,showHistogramToggle:H=!0,selectedLog:Q,isSelectedLogLoading:U,selectedLogError:K,onSelectedLogChange:W})=>{let{ref:V}=(0,i.useParams)(),{profile:G}=(0,u.useProfile)(),[Y]=(0,c.useSelectedLog)(),{show:X}=(0,j.useContextMenu)(),[Z,ee]=(0,g.useState)(),[et,es]=(0,g.useState)(!1),[er,ea]=(0,g.useState)(null),{can:el}=(0,d.useAsyncCheckPermissions)(a.PermissionAction.CREATE,"user_content",{resource:{type:"log_sql",owner_id:G?.id},subject:{id:G?.id}}),ei=e[0],en=Object.keys(function(){if(!ei)return{};let{timestamp:e,...t}=ei;return e?{timestamp:e,...t}:ei}()||{}),eo=en.includes("id"),ec=en.includes("timestamp"),ed="logs-explorer-context-menu",eu=en.map((e,t)=>({key:`logs-column-${t}`,name:e,resizable:!0,renderCell:({row:t})=>(0,r.jsx)("span",{onContextMenu:s=>{s.preventDefault(),ee({row:t,column:{name:e}}),X(s,{id:ed})},children:ej(t?.[e])}),renderHeaderCell:()=>(0,r.jsx)("div",{className:"flex items-center",children:e}),minWidth:128})),em=eu;if(t)switch(t){case"api":em=F;break;case"database":case"pg_cron":em=I;break;case"fn_edge":em=O;break;case"functions":em=E;break;case"auth":em=D;break;default:em=ei&&(0,L.isDefaultLogPreviewFormat)(ei)?R:eu}let[ex,eh]=(0,g.useMemo)(()=>{let t=[...new Set(e)];if(!eo)return[t,{}];let s=t.reduce((e,t)=>(e[t.id]=t,e),{});return[t,s]},[e,eo]),ep=(0,g.useMemo)(()=>eo&&ec?Object.values(eh).sort((e,t)=>t.timestamp-e.timestamp):ex,[ex,eo,ec,eh]),ef=(0,g.useCallback)((e,t)=>(0,r.jsx)(v.Row,{...t,isRowSelected:!1,selectedCellIdx:void 0,onContextMenu:e=>{em.length>0&&ee({row:t.row,column:em[0]}),X(e,{id:ed})}},e),[em,X]),ej=e=>e&&"object"==typeof e?JSON.stringify(e):null===e?"NULL":String(e);function ev(e){ea(e),W?.(e)}let ew=(0,g.useCallback)(e=>{if(!ep.length||!er)return;let t=ep.findIndex(e=>(0,m.default)(e,er));-1!==t&&("ArrowUp"===e.key&&t>0?ev(ep[t-1]):"ArrowDown"===e.key&&t<ep.length-1&&ev(ep[t+1]))},[ep,er,ev]);return((0,g.useEffect)(()=>{(Q||U)&&es(!0),U||Q||ea(null)},[Q,U]),(0,g.useEffect)(()=>(window.addEventListener("keydown",ew),()=>{window.removeEventListener("keydown",ew)}),[ew]),(0,g.useEffect)(()=>{if(!T&&!er){let t=e.find(e=>e.id===Y);t&&ea(t)}},[T]),e)?(0,r.jsxs)("section",{className:"h-full flex w-full flex-col flex-1",children:[!t&&(0,r.jsx)(()=>(0,r.jsxs)("div",{className:(0,b.cn)("flex w-full items-center justify-between border-t bg-surface-100 px-5 py-2",q,{hidden:!B}),children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)(o.DownloadResultsButton,{type:"text",text:`Results ${e&&e.length?`(${e.length})`:""}`,results:e,fileName:`supabase-logs-${V}.csv`})}),H&&(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)(N.Button,{type:"default",icon:k?(0,r.jsx)(h.Eye,{}):(0,r.jsx)(p.EyeOff,{}),onClick:s,children:"Histogram"})}),(0,r.jsxs)("div",{className:"space-x-2",children:[l.IS_PLATFORM&&(0,r.jsx)(n.ButtonTooltip,{type:"default",onClick:z,loading:_,disabled:!el||!$,tooltip:{content:{side:"bottom",text:el?void 0:"You need additional permissions to save your query"}},children:"Save query"}),(0,r.jsx)(N.Button,{title:"run-logs-query",type:$?"primary":"alternative",disabled:!$,onClick:A,iconRight:(0,r.jsx)(f.Play,{size:12}),loading:T,children:"Run"})]})]}),{}),(0,r.jsxs)(C.ResizablePanelGroup,{direction:"horizontal",children:[(0,r.jsxs)(C.ResizablePanel,{id:"log-table-content",order:1,minSize:40,maxSize:60,defaultSize:60,children:[(0,r.jsx)(v.default,{role:"table",style:{height:"100%"},className:(0,b.cn)("flex-1 flex-grow h-full border-0",{"data-grid--simple-logs":t,"data-grid--logs-explorer":!t}),rowHeight:40,headerRowHeight:28*!t,onSelectedCellChange:e=>{ee(e)},onCellClick:e=>{ev(e.row)},columns:em,rowClass:e=>(0,b.cn)("font-mono tracking-tight !bg-studio hover:!bg-surface-100 cursor-pointer",{"!bg-surface-200 rdg-row--focused":(0,m.default)(e,er)}),rows:ep,rowKeyGetter:e=>eo?e.id:JSON.stringify(e),renderers:{renderRow:ef,noRowsFallback:T?null:(0,r.jsxs)(r.Fragment,{children:[0===ep.length&&!M&&(0,r.jsx)(()=>J||(0,r.jsx)(ek,{}),{}),M&&(0,r.jsx)(()=>{if(!M)return null;let e={isCustomQuery:!t,error:M};return"object"==typeof M&&M.error?.errors.find(e=>"resourcesExceeded"===e.reason)?(0,r.jsx)(eb,{...e}):(0,r.jsx)("div",{className:"text-foreground flex gap-2 font-mono p-4",children:(0,r.jsx)(ey,{...e})})},{})]})}}),(0,y.createPortal)((0,r.jsx)(j.Menu,{id:ed,animation:!1,children:(0,r.jsxs)(j.Item,{onClick:()=>{if(!Z)return;let e=Z.row.event_message;(0,S.copyToClipboard)(e,()=>{w.toast.success("Copied to clipboard")})},children:[(0,r.jsx)(x.Copy,{size:14}),(0,r.jsx)("span",{className:"ml-2 text-xs",children:"Copy event message"})]})}),document.body)]}),et&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.ResizableHandle,{withHandle:!0}),(0,r.jsx)(C.ResizablePanel,{id:"log-table-panel",order:2,minSize:40,maxSize:60,defaultSize:40,children:(0,r.jsx)(eg,{isLoading:U||!1,projectRef:P,onClose:()=>{W?.(null),es(!1)},log:Q,error:K,queryType:t})})]})]})]}):null}],651068)},744244,e=>{"use strict";var t=e.i(478902);e.s(["default",0,({children:e,active:s,className:r})=>(0,t.jsx)("div",{className:[r,"flex h-full flex-grow transition-opacity ",s?"opacity-30":"opacity-100"].join(" "),children:e})])},169240,e=>{"use strict";var t=e.i(460988),s=e.i(389959),r=e.i(280590);e.s(["useUpgradePrompt",0,e=>{let[a,l]=(0,s.useState)(!1),{getEntitlementNumericValue:i}=(0,r.useCheckEntitlements)("log.retention_days"),n=i(),o=(0,t.maybeShowUpgradePromptIfNotEntitled)(e,n);return(0,s.useEffect)(()=>{o&&l(!0)},[e]),{showUpgradePrompt:a,setShowUpgradePrompt:l,shouldShowUpgradePrompt:o}}])}]);

//# debugId=efdb152c-ae30-b333-a0b1-7f6184dbb63e
//# sourceMappingURL=f392db46abc8a303.js.map